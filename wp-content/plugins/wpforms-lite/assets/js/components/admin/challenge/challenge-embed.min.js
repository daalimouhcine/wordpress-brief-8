"use strict";var WPFormsChallenge=window.WPFormsChallenge||{};WPFormsChallenge.embed=window.WPFormsChallenge.embed||function(o,e,i){var t={init:function(){i(t.ready),i(e).on("load",function(){"function"==typeof i.ready.then?i.ready.then(t.load):t.load()})},ready:function(){t.setup(),t.events(),t.observeFullscreenMode()},load:function(){if(-1<e.location.href.indexOf("post-new.php"))return t.lastStep(),void i(".wpforms-challenge-dot-completed").hide();WPFormsChallenge.core.isGutenberg()?(WPFormsChallenge.core.initTooltips(5,".block-editor .edit-post-header",{side:"bottom"}),t.updateTooltipVisibility()):WPFormsChallenge.core.initTooltips(5,".wpforms-insert-form-button",{side:"right"}),WPFormsChallenge.core.updateTooltipUI()},setup:function(){5===WPFormsChallenge.core.loadStep()&&(i(".wpforms-challenge").addClass("wpforms-challenge-completed"),t.showPopup()),i(".wpforms-challenge").show()},events:function(){i(".wpforms-challenge-step5-done").on("click",t.lastStep),i(".wpforms-challenge-popup-close, .wpforms-challenge-end").on("click",t.completeChallenge),i("#wpforms-challenge-contact-form .wpforms-challenge-popup-contact-btn").on("click",t.submitContactForm)},lastStep:function(){WPFormsChallenge.core.timer.pause(),WPFormsChallenge.core.stepCompleted(5),i(".wpforms-challenge").addClass("wpforms-challenge-completed"),t.showPopup()},showPopup:function(){var e=WPFormsChallenge.core.timer.getSecondsLeft();i(".wpforms-challenge-popup-container").show(),0<e?(e=WPFormsChallenge.core.timer.getSecondsSpent(e),i("#wpforms-challenge-congrats-minutes").text(WPFormsChallenge.core.timer.getMinutesFormatted(e)),i("#wpforms-challenge-congrats-seconds").text(WPFormsChallenge.core.timer.getSecondsFormatted(e)),i("#wpforms-challenge-congrats-popup").show()):i("#wpforms-challenge-contact-popup").show()},hidePopup:function(){i(".wpforms-challenge-popup-container").hide(),i(".wpforms-challenge-popup").hide()},completeChallenge:function(){var e={status:"completed",seconds_spent:WPFormsChallenge.core.timer.getSecondsSpent(),seconds_left:WPFormsChallenge.core.timer.getSecondsLeft()};t.hidePopup(),WPFormsChallenge.core.removeChallengeUI(),WPFormsChallenge.core.clearLocalStorage(),WPFormsChallenge.admin.saveChallengeOption(e).done(WPFormsChallenge.core.triggerPageSave)},submitContactForm:function(e){e.preventDefault();var o=i(this),e=o.closest("#wpforms-challenge-contact-form"),e={action:"wpforms_challenge_send_contact_form",_wpnonce:WPFormsChallenge.admin.l10n.nonce,contact_data:{message:e.find(".wpforms-challenge-contact-message").val(),contact_me:e.find(".wpforms-challenge-contact-permission").prop("checked")}};o.prop("disabled",!0),i.post(ajaxurl,e,function(e){e.success||console.error("Error sending WPForms Challenge Contact Form.")}).done(t.completeChallenge)},observeFullscreenMode:function(){var a=i("body"),c=a.hasClass("is-fullscreen-mode"),e={targetNode:a[0],config:{attributes:!0},callback:function(e,o){var t,l,n,s=i(".wpforms-challenge-tooltip-step5"),r=s.find(".tooltipster-arrow");for(n in e)"attributes"===(t=e[n]).type&&"class"===t.attributeName&&(l=a.hasClass("is-fullscreen-mode"))!==c&&((c=l)?(s.css({top:"93px",left:"0"}),r.css("left","91px")):(s.css({top:"125px",left:"66px"}),r.css("left","130px")))}};e.observer=new MutationObserver(e.callback),e.observer.observe(e.targetNode,e.config)},updateTooltipVisibility:function(){var e=o.querySelector(".interface-interface-skeleton__body");if(null===e)return t.updateTooltipVisibilityDefault();new MutationObserver(function(e){var o,t=i(".wpforms-challenge-tooltip-step5");for(o of e)"childList"===o.type&&t.toggleClass("wpforms-challenge-tooltip-step5-hide")}).observe(e,{attributes:!0,childList:!0})},updateTooltipVisibilityDefault:function(){i(".editor-inserter__toggle").on("click",function(){i(".wpforms-challenge-tooltip-step5").toggleClass("wpforms-challenge-tooltip-step5-hide")})}};return t}(document,window,jQuery),WPFormsChallenge.embed.init();