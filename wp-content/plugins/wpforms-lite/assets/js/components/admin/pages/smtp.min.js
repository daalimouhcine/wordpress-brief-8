"use strict";var WPFormsPagesSMTP=window.WPFormsPagesSMTP||function(e,i){var l={},r={init:function(){i(r.ready)},ready:function(){r.initVars(),r.events()},initVars:function(){l={$stepInstall:i("section.step-install"),$stepInstallNum:i("section.step-install .num img"),$stepSetup:i("section.step-setup"),$stepSetupNum:i("section.step-setup .num img")}},events:function(){l.$stepInstall.on("click","button",r.stepInstallClick),l.$stepSetup.on("click","button",r.gotoURL)},stepInstallClick:function(){var s=i(this),n=s.attr("data-action"),t=s.attr("data-plugin"),a="";if(!s.hasClass("disabled")){switch(n){case"activate":a="wpforms_activate_addon",s.text(wpforms_pluginlanding.activating);break;case"install":a="wpforms_install_addon",s.text(wpforms_pluginlanding.installing);break;case"goto-url":return void(e.location.href=s.attr("data-url"));default:return}s.addClass("disabled"),r.showSpinner(l.$stepInstallNum);t={action:a,nonce:wpforms_admin.nonce,plugin:t,type:"plugin"};i.post(wpforms_admin.ajax_url,t).done(function(t){r.stepInstallDone(t,s,n)}).always(function(){r.hideSpinner(l.$stepInstallNum)})}},stepInstallDone:function(t,s,n){if("install"===n?t.success&&t.data.is_activated:t.success)return l.$stepInstallNum.attr("src",l.$stepInstallNum.attr("src").replace("step-1.","step-complete.")),s.addClass("grey").removeClass("button-primary").text(wpforms_pluginlanding.activated),void r.stepInstallPluginStatus();var a="install"===n&&t.success&&!t.data.is_activated||"activate"===n,t=a?wpforms_pluginlanding.manual_activate_url:wpforms_pluginlanding.manual_install_url,n=a?wpforms_pluginlanding.error_could_not_activate:wpforms_pluginlanding.error_could_not_install,a=a?wpforms_pluginlanding.plugins_page:wpforms_pluginlanding.download_now;s.removeClass("grey disabled").text(a).attr("data-action","goto-url").attr("data-url",t),s.after('<p class="error">'+n+"</p>")},stepInstallPluginStatus:function(){var t={action:"wpforms_smtp_page_check_plugin_status",nonce:wpforms_admin.nonce};i.post(wpforms_admin.ajax_url,t).done(r.stepInstallPluginStatusDone)},stepInstallPluginStatusDone:function(t){if(t.success){if(l.$stepSetup.removeClass("grey"),l.$stepSetupBtn=l.$stepSetup.find("button"),l.$stepSetupBtn.removeClass("grey disabled").addClass("button-primary"),0<t.data.setup_status)return l.$stepSetupNum.attr("src",l.$stepSetupNum.attr("src").replace("step-2.svg","step-complete.svg")),void l.$stepSetupBtn.attr("data-url",wpforms_pluginlanding.smtp_settings_url).text(wpforms_pluginlanding.smtp_settings);l.$stepSetupBtn.attr("data-url",wpforms_pluginlanding.smtp_wizard_url).text(wpforms_pluginlanding.smtp_wizard)}},gotoURL:function(){var t=i(this);t.hasClass("disabled")||(e.location.href=t.attr("data-url"))},showSpinner:function(t){t.siblings(".loader").removeClass("hidden")},hideSpinner:function(t){t.siblings(".loader").addClass("hidden")}};return r}((document,window),jQuery);WPFormsPagesSMTP.init();