var WPFormsBuilder=window.WPFormsBuilder||function(r,a,h){var g,b,p={},i=!0,l=!1,v={settings:{spinner:'<i class="wpforms-loading-spinner"></i>',spinnerInline:'<i class="wpforms-loading-spinner wpforms-loading-inline"></i>',tinymceDefaults:{tinymce:{toolbar1:"bold,italic,underline,blockquote,strikethrough,bullist,numlist,alignleft,aligncenter,alignright,undo,redo,link"},quicktags:!0},pagebreakTop:!1,pagebreakBottom:!1,upload_img_modal:!1},init:function(){var e=this;wpforms_panel_switch=!0,g=this.settings,h(v.ready),h(a).on("load",function(){"function"==typeof h.ready.then?h.ready.then(v.load):v.load()}),h(a).on("beforeunload",function(){if(!e.formIsSaved()&&i)return wpforms_builder.are_you_sure_to_close})},load:function(){"revisions"===h("#wpforms-panels-toggle .active").data("panel")&&v.updateRevisionPreview(),v.hideLoadingOverlay(),"1"==wpforms_builder.template_modal_display&&"fields"===wpf.getQueryString("view")&&h.alert({title:wpforms_builder.template_modal_title,content:wpforms_builder.template_modal_msg,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:wpforms_builder.close,btnClass:"btn-confirm",keys:["enter"]}}})},ready:function(){v.isVisitedViaBackButton()?location.reload():(b=h("#wpforms-builder"),p.$helpButton=h("#wpforms-help"),p.$previewButton=h("#wpforms-preview-btn"),p.$embedButton=h("#wpforms-embed"),p.$saveButton=h("#wpforms-save"),p.$exitButton=h("#wpforms-exit"),p.$fieldOptions=h("#wpforms-field-options"),p.$sortableFieldsWrap=h("#wpforms-panel-fields .wpforms-field-wrap"),p.$noFieldsOptions=h("#wpforms-panel-fields .wpforms-no-fields-holder .no-fields"),p.$noFieldsPreview=h("#wpforms-panel-fields .wpforms-no-fields-holder .no-fields-preview"),p.$addFieldsButtons=h(".wpforms-add-fields-button").not(".not-draggable").not(".warning-modal").not(".education-modal"),p.$formPreview=h("#wpforms-panel-fields .wpforms-preview-wrap"),p.$revisionPreview=h("#wpforms-panel-revisions .wpforms-panel-content"),v.isBuilderInPopup()&&(p.$embedButton.remove(),p.$previewButton.addClass("wpforms-alone")),v.loadMsWinCSS(),v.bindUIActions(),wpf.getQueryString("newform")&&v.formSave(!1),g.formID=h("#wpforms-builder-form").data("id"),g.pagebreakTop=h(".wpforms-pagebreak-top").length,g.pagebreakBottom=h(".wpforms-pagebreak-bottom").length,b.on("keypress","#wpforms-builder-form :input:not(textarea)",function(e){13===e.keyCode&&e.preventDefault()}),h(".wpforms-panel").each(function(e,i){var o,t=h(this),r=t.find(".wpforms-panel-sidebar-section.configured").first();r.length?(o=r.data("section"),r.addClass("active"),t.find(".wpforms-panel-content-section-"+o).show().addClass("active"),t.find(".wpforms-panel-content-section-default").hide()):(t.find(".wpforms-panel-content-section:first-of-type").show().addClass("active"),t.find(".wpforms-panel-sidebar-section:first-of-type").addClass("active"))}),v.loadEntryPreviewFields(),v.fieldSortable(),v.fieldChoiceSortable("select"),v.fieldChoiceSortable("radio"),v.fieldChoiceSortable("checkbox"),v.fieldChoiceSortable("payment-multiple"),v.fieldChoiceSortable("payment-checkbox"),v.fieldChoiceSortable("payment-select"),h(".wpforms-add-fields-group").each(function(e,i){v.fieldGroupToggle(h(this),"load")}),v.registerTemplates(),v.trimFormTitle(),wpf.initTooltips(),v.loadColorPickers(),v.captchaToggle(),v.confirmationsSetup(),v.notificationToggle(),v.notificationsByStatusAlerts(),v.builderHotkeys(),h("#wpforms-setup-name").val(h("#wpforms-panel-field-settings-form_title").val()),jconfirm.defaults={closeIcon:!1,backgroundDismiss:!1,escapeKey:!0,animationBounce:1,useBootstrap:!1,theme:"modern",boxWidth:"400px",animateFromElement:!1,content:wpforms_builder.something_went_wrong},v.dropdownField.init(),v.initSomeFieldOptions(),v.dismissNotice())},loadMsWinCSS:function(){var e=navigator.userAgent;e.indexOf("Windows")<0||e.indexOf("Chrome")<0&&e.indexOf("Firefox")<0||h("<link>").appendTo("head").attr({type:"text/css",rel:"stylesheet",href:wpforms_builder.ms_win_css_url})},isVisitedViaBackButton:function(){if(!performance)return!1;var i=!1;return performance.getEntriesByType("navigation").forEach(function(e){"back_forward"===e.type&&(i=!0)}),i},hideLoadingOverlay:function(){var e=h("#wpforms-builder-overlay");e.addClass("fade-out"),setTimeout(function(){e.hide()},250)},showLoadingOverlay:function(){var e=h("#wpforms-builder-overlay");e.removeClass("fade-out"),e.show()},initSomeFieldOptions:function(){v.toggleAllOptionGroups(b),b.find(".wpforms-field-option-row-date .type select").trigger("change")},dropdownField:{config:{modernClass:"choicesjs-select",args:{searchEnabled:!1,searchChoices:!1,renderChoiceLimit:1,shouldSort:!1,callbackOnInit:function(){var e=h(this.containerOuter.element),i=e.closest(".wpforms-field").find("select");e.hasClass("is-disabled")&&e.removeClass("is-disabled"),i.is("[readonly]")&&(this.disable(),i.prop("disabled",!1)),this.passedElement.element.multiple&&this.getValue(!0).length&&h(this.input.element).addClass("choices__input--hidden")}}},init:function(){b.find("."+v.dropdownField.config.modernClass).each(function(){v.dropdownField.events.choicesInit(h(this))}),b.on("change",".wpforms-field-option-select .wpforms-field-option-row-multiple input",v.dropdownField.events.multiple),b.on("change",".wpforms-field-option-select .wpforms-field-option-row-style select, .wpforms-field-option-payment-select .wpforms-field-option-row-style select",v.dropdownField.events.applyStyle)},events:{choicesInit:function(e){var i=new Choices(e[0],v.dropdownField.config.args);v.dropdownField.helpers.setInstance(e,i),v.dropdownField.helpers.addPlaceholderChoice(e,i)},multiple:function(e){var i=h(this).closest(".wpforms-field-option-row-multiple").data().fieldId,o=v.dropdownField.helpers.getPrimarySelector(i),t=h("#wpforms-field-option-row-"+i+"-choices input.default"),r=o.find(".placeholder"),s=v.dropdownField.helpers.isDynamicChoices(i),n=e.target.checked,e=n?"checkbox":"radio";o.prop("multiple",n),t.prop("type",e),s&&o.find("option:selected").prop("selected",!1),o=t.filter(":checked"),!n&&o.length&&(t.prop("checked",!1),h(o.get(0)).prop("checked",!0)),r.length&&r.prop("selected",!n),v.dropdownField.helpers.update(i,s)},applyStyle:function(){var e=h(this),i=e.closest(".wpforms-field-option-row-style").data().fieldId;"modern"===e.val()?v.dropdownField.helpers.convertClassicToModern(i):v.dropdownField.helpers.convertModernToClassic(i)}},helpers:{convertModernToClassic:function(e){var i=v.dropdownField.helpers.getPrimarySelector(e),o=v.dropdownField.helpers.isDynamicChoices(e),i=v.dropdownField.helpers.getInstance(i);i.destroy(),v.dropdownField.helpers.updatePlaceholderChoice(i,e),o||v.fieldChoiceUpdate("select",e)},convertClassicToModern:function(e){var i=v.dropdownField.helpers.getPrimarySelector(e);v.dropdownField.helpers.isDynamicChoices(e)||v.fieldChoiceUpdate("select",e),v.dropdownField.events.choicesInit(i)},update:function(e,i){var o=v.dropdownField.helpers.getPrimarySelector(e);v.dropdownField.helpers.isModernSelect(o)?(v.dropdownField.helpers.convertModernToClassic(e),v.dropdownField.events.choicesInit(o)):i||v.fieldChoiceUpdate("select",e)},addPlaceholderChoice:function(e,i){var o=e.closest(".wpforms-field").data().fieldId,t=v.dropdownField.helpers.hasDefaults(o);if(v.dropdownField.helpers.isDynamicChoices(o)&&(t=!1),!1!==v.dropdownField.helpers.searchPlaceholderChoice(i))return!1;if(!i.config.choices.length)return!1;e=i.config.choices[0].label,o=h(i.passedElement.element).prop("multiple");return i.setChoices([{value:"",label:e,selected:!(o||t),placeholder:!0}],"value","label",!1),o&&h(i.input.element).prop("placeholder",e),!0},searchPlaceholderChoice:function(e){var t=!1;return e.config.choices.forEach(function(e,i,o){if(void 0!==e.placeholder&&!0===e.placeholder)return!(t={key:i,item:e})}),t},updatePlaceholderChoice:function(e,i){var o=h(e.passedElement.element),t=wpf.sanitizeHTML(h("#wpforms-field-option-"+i+"-placeholder").val()),i=v.dropdownField.helpers.searchPlaceholderChoice(e),e={};"object"==typeof i&&(e=h(o.find("option").get(i.key))),""!==t?!h.isEmptyObject(e)&&e.length?e.addClass("placeholder").text(t):o.prepend('<option value="" class="placeholder">'+t+"</option>"):e.length&&e.remove()},isModernSelect:function(e){e=v.dropdownField.helpers.getInstance(e);return"object"==typeof e&&(!h.isEmptyObject(e)&&e.initialised)},setInstance:function(e,i){e.data("choicesjs",i)},getInstance:function(e){return e.data("choicesjs")},isDynamicChoices:function(e){e=h("#wpforms-field-option-"+e+"-dynamic_choices");return!!e.length&&""!==e.val()},hasDefaults:function(e){return!!h("#wpforms-field-option-row-"+e+"-choices .choices-list").find("input.default:checked").length},getPrimarySelector:function(e){return h("#wpforms-field-"+e+" .primary-input")}}},numberSliderEvents:function(e){e.on("input",".wpforms-field-option-row-min_max .wpforms-input-row .wpforms-number-slider-min",v.fieldNumberSliderUpdateMin),e.on("input",".wpforms-field-option-row-min_max .wpforms-input-row .wpforms-number-slider-max",v.fieldNumberSliderUpdateMax),e.on("input",".wpforms-number-slider-default-value",_.debounce(v.changeNumberSliderDefaultValue,500)),e.on("input",".wpforms-number-slider-step",_.debounce(v.changeNumberSliderStep,500)),e.on("focusout",".wpforms-number-slider-step",v.checkNumberSliderStep),e.on("input",".wpforms-number-slider-value-display",_.debounce(v.changeNumberSliderValueDisplay,500)),e.on("input",".wpforms-number-slider-min",_.debounce(v.changeNumberSliderMin,500)),e.on("input",".wpforms-number-slider-max",_.debounce(v.changeNumberSliderMax,500))},changeNumberSliderMin:function(e){var i=h(e.target).parents(".wpforms-field-option-row").data("fieldId"),o=parseFloat(e.target.value);isNaN(o)||v.updateNumberSliderDefaultValueAttr(i,e.target.value,"min")},changeNumberSliderMax:function(e){var i=h(e.target).parents(".wpforms-field-option-row").data("fieldId"),o=parseFloat(e.target.value);isNaN(o)||v.updateNumberSliderDefaultValueAttr(i,e.target.value,"max").updateNumberSliderStepValueMaxAttr(i,e.target.value)},changeNumberSliderValueDisplay:function(e){var i=e.target.value,o=h(e.target).parents(".wpforms-field-option-row").data("fieldId"),e=r.getElementById("wpforms-field-option-"+o+"-default_value");e&&v.updateNumberSliderHintStr(o,i).updateNumberSliderHint(o,e.value)},changeNumberSliderStep:function(e){var i,o,t,r=parseFloat(e.target.value);isNaN(r)||(i=parseFloat(e.target.max),o=parseFloat(e.target.min),t=h(e.target).parents(".wpforms-field-option-row").data("fieldId"),r<=0||(i<r?e.target.value=i:r<o?e.target.value=o:v.updateNumberSliderAttr(t,r,"step").updateNumberSliderDefaultValueAttr(t,r,"step")))},checkNumberSliderStep:function(e){var e=parseFloat(e.target.value),i=h(this);!isNaN(e)&&0<e||h.confirm({title:wpforms_builder.heads_up,content:wpforms_builder.error_number_slider_increment,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){i.val("").focus()}}}})},changeNumberSliderDefaultValue:function(e){var i,o,t,r=parseFloat(e.target.value);isNaN(r)||(i=parseFloat(e.target.max),o=parseFloat(e.target.min),t=h(e.target).parents(".wpforms-field-option-row-default_value").data("fieldId"),i<r?e.target.value=i:r<o?e.target.value=o:v.updateNumberSlider(t,r).updateNumberSliderHint(t,r))},updateNumberSliderDefaultValueAttr:function(e,i,o){var t=r.getElementById("wpforms-field-option-"+e+"-default_value");return t&&(e=parseFloat(t.value),t.setAttribute(o,i),i=parseFloat(i),"max"===o&&i<e&&(t.value=i,h(t).trigger("input")),"min"===o&&e<i&&(t.value=i,h(t).trigger("input"))),this},updateNumberSlider:function(e,i){e=r.getElementById("wpforms-number-slider-"+e);return e&&(e.value=i),this},updateNumberSliderAttr:function(e,i,o){e=r.getElementById("wpforms-number-slider-"+e);return e&&e.setAttribute(o,i),this},updateNumberSliderHintStr:function(e,i){e=r.getElementById("wpforms-number-slider-hint-"+e);return e&&(e.dataset.hint=i),this},updateNumberSliderHint:function(e,i){e=r.getElementById("wpforms-number-slider-hint-"+e);return e&&(e.innerHTML=wpf.sanitizeHTML(e.dataset.hint).replace("{value}","<b>"+i+"</b>")),this},fieldNumberSliderUpdateMin:function(e){var i=h(e.target).parents(".wpforms-field-option-row-min_max"),o=parseFloat(i.find(".wpforms-number-slider-max").val()),t=parseFloat(e.target.value);if(!isNaN(t)){if(o<=t)return e.preventDefault(),void(this.value=o);i=i.data("field-id");b.find("#wpforms-field-"+i+' input[type="range"]').attr("min",t)}},fieldNumberSliderUpdateMax:function(e){var i=h(e.target).parents(".wpforms-field-option-row-min_max"),o=parseFloat(i.find(".wpforms-number-slider-min").val()),t=parseFloat(e.target.value);if(!isNaN(t)){if(t<=o)return e.preventDefault(),void(this.value=o);i=i.data("field-id");b.find("#wpforms-field-"+i+' input[type="range"]').attr("max",t)}},updateNumberSliderStepValueMaxAttr:function(e,i){var o=r.getElementById("wpforms-field-option-"+e+"-step");return o&&(e=parseFloat(o.value),o.setAttribute("max",i),(i=parseFloat(i))<e&&(o.value=i,h(o).trigger("input"))),this},fieldFileUploadPreviewUpdate:function(e){var i=h(e).parents(".wpforms-field-option-file-upload"),o=i.data("field-id"),t=i.find("#wpforms-field-option-"+o+"-style").val(),r=i.find("#wpforms-field-option-row-"+o+"-max_file_number"),s=parseInt(r.find("input").val(),10),e=h("#wpforms-field-"+o),i=".wpforms-file-upload-builder-classic",o=".wpforms-file-upload-builder-modern";"classic"===t?(h(i,e).removeClass("wpforms-hide"),h(o,e).addClass("wpforms-hide"),r.addClass("wpforms-hidden")):(1<s?(e.find(".modern-title").text(wpforms_builder.file_upload.preview_title_plural),e.find(".modern-hint").text(wpforms_builder.file_upload.preview_hint.replace("{maxFileNumber}",s)).removeClass("wpforms-hide")):(e.find(".modern-title").text(wpforms_builder.file_upload.preview_title_single),e.find(".modern-hint").text(wpforms_builder.file_upload.preview_hint.replace("{maxFileNumber}",1)).addClass("wpforms-hide")),h(i,e).addClass("wpforms-hide"),h(o,e).removeClass("wpforms-hide"),r.removeClass("wpforms-hidden"))},updateTextFieldsLimitControls:function(e,i){i?h("#wpforms-field-option-row-"+e+"-limit_controls").removeClass("wpforms-hide"):h("#wpforms-field-option-row-"+e+"-limit_controls").addClass("wpforms-hide")},updatePasswordStrengthControls:function(e,i){e=h("#wpforms-field-option-row-"+e+"-password-strength-level");i?e.removeClass("wpforms-hidden"):e.addClass("wpforms-hidden")},updateRichTextMediaFieldsLimitControls:function(){var e=h(this),i=e.closest(".wpforms-field-option-row-media_enabled").data("field-id"),o=h("#wpforms-field-option-row-"+i+"-media_controls"),i=h("#wpforms-field-"+i+" .wpforms-richtext-wrap .mce-toolbar-grp");e.is(":checked")?(o.show(),i.addClass("wpforms-field-richtext-media-enabled")):(o.hide(),i.removeClass("wpforms-field-richtext-media-enabled"))},updateRichTextStylePreview:function(){var e=h(this),i=e.closest(".wpforms-field-option-row-style").data("field-id");h("#wpforms-field-"+i+" .wpforms-richtext-wrap .mce-toolbar-grp").toggleClass("wpforms-field-richtext-toolbar-basic","full"!==e.val())},bindUIActions:function(){v.bindUIActionsPanels(),v.bindUIActionsFields(),v.bindUIActionsSettings(),v.bindUIActionsRevisions(),v.bindUIActionsSaveExit(),v.bindUIActionsGeneral()},bindUIActionsPanels:function(){b.on("click","#wpforms-panels-toggle button, .wpforms-panel-switch",function(e){e.preventDefault(),v.panelSwitch(h(this).data("panel"))}),b.on("click",".wpforms-panel .wpforms-panel-sidebar-section",function(e){v.panelSectionSwitch(this,e)})},panelSwitch:function(e){var i=h("#wpforms-panel-"+e),o=h(".wpforms-panel-"+e+"-button");if(!i.hasClass("active")){if(b.trigger("wpformsPanelSwitch",[e]),!wpforms_panel_switch)return!1;h("#wpforms-panels-toggle").find("button").removeClass("active"),h(".wpforms-panel").removeClass("active"),o.addClass("active"),i.addClass("active"),history.replaceState({},null,wpf.updateQueryString("view",e)),b.trigger("wpformsPanelSwitched",[e])}},panelSectionSwitch:function(e,i){i&&i.preventDefault();var o=h(e),t=o.parent().parent(),r=o.data("section"),i=t.find(".wpforms-panel-sidebar-section"),e=t.find(".wpforms-panel-sidebar-section-"+r);o.hasClass("upgrade-modal")||o.hasClass("education-modal")||e.hasClass("active")||(b.trigger("wpformsPanelSectionSwitch",r),i.removeClass("active"),e.addClass("active"),t.find(".wpforms-panel-content-section").hide(),t.find(".wpforms-panel-content-section-"+r).show())},bindUIActionsSetup:function(){console.warn('WARNING! Function "WPFormsBuilder.bindUIActionsSetup()" has been deprecated, please use the new "WPForms.Admin.Builder.Setup.events()" function instead!'),WPForms.Admin.Builder.Setup.events()},templateSelect:function(e,i){console.warn('WARNING! Function "WPFormsBuilder.templateSelect()" has been deprecated, please use the new "WPForms.Admin.Builder.Setup.selectTemplate()" function instead!'),WPForms.Admin.Builder.Setup.selectTemplate(i)},bindUIActionsFields:function(){b.on("click",".wpforms-tab a",function(e){e.preventDefault(),v.fieldTabToggle(h(this).parent().attr("id"))}),b.on("click",".wpforms-add-fields-heading",function(e){e.preventDefault(),v.fieldGroupToggle(h(this),"click")}),b.on("click",".wpforms-field",function(e){v.isFieldPreviewActionsDisabled(this)||v.fieldTabToggle(h(this).data("field-id"))}),b.on("mousedown click",".wpforms-field input, .wpforms-field select, .wpforms-field textarea",function(e){e.preventDefault(),this.blur()}),b.on("click",".wpforms-field-delete",function(e){e.preventDefault(),e.stopPropagation(),v.isFieldPreviewActionsDisabled(this)||v.fieldDelete(h(this).parent().data("field-id"))}),b.on("click",".wpforms-field-duplicate",function(e){e.preventDefault(),e.stopPropagation(),v.isFieldPreviewActionsDisabled(this)||v.fieldDuplicate(h(this).parent().data("field-id"))}),b.on("click",".wpforms-add-fields-button",function(e){e.preventDefault();e=h(this);e.hasClass("ui-draggable-disabled")||v.fieldAdd(e.data("field-type"))}),b.on("wpformsFieldAdd",function(e,i,o){"select"!==o&&"radio"!==o&&"checkbox"!==o&&"payment-multiple"!==o&&"payment-checkbox"!==o&&"payment-select"!==o||v.fieldChoiceSortable(o,"#wpforms-field-option-row-"+i+"-choices ul")}),b.on("click",".wpforms-field-option-row-choices .add",function(e){v.fieldChoiceAdd(e,h(this))}),b.on("click",".wpforms-field-option-row-choices .remove",function(e){v.fieldChoiceDelete(e,h(this))}),b.on("mousedown",".wpforms-field-option-row-choices input[type=radio]",function(e){var i=h(this);i.is(":checked")?i.attr("data-checked","1"):i.attr("data-checked","0")}),b.on("click",".wpforms-field-option-row-choices input[type=radio]",function(e){var i=h(this),o=i.parent().parent();i.parent().parent().find("input[type=radio]").not(this).prop("checked",!1),"1"===i.attr("data-checked")&&(i.prop("checked",!1),i.attr("data-checked","0")),v.fieldChoiceUpdate(o.data("field-type"),o.data("field-id"))}),b.on("change",".wpforms-field-option-row-choices input[type=checkbox]",function(e){var i=h(this).parent().parent();v.fieldChoiceUpdate(i.data("field-type"),i.data("field-id"))}),b.on("change",".wpforms-field-option-row-show_values input",function(e){h(this).closest(".wpforms-field-option").find(".wpforms-field-option-row-choices ul").toggleClass("show-values")}),b.on("change",".wpforms-field-option-row-choices_images input",function(){var e=h(this),i=e.closest(".wpforms-field-option-row"),o=i.data("field-id"),t=h("#wpforms-field-option-"+o),r=e.is(":checked"),e=t.find(".wpforms-field-option-hidden-type").val();i.find(".wpforms-alert").toggleClass("wpforms-hidden"),t.find(".wpforms-field-option-row-choices ul").toggleClass("show-images"),t.find(".wpforms-field-option-row-choices_images_style").toggleClass("wpforms-hidden"),t.find(".wpforms-field-option-row-dynamic_choices").toggleClass("wpforms-hidden",r),(r?h("#wpforms-field-option-"+o+"-input_columns").val("inline"):h("#wpforms-field-option-"+o+"-input_columns").val("")).trigger("change"),v.fieldChoiceUpdate(e,o)}),b.on("wpformsImageUploadAdd wpformsImageUploadRemove",function(e,i,o){var t=o.closest(".choices-list"),o=t.data("field-id"),t=t.data("field-type");v.fieldChoiceUpdate(t,o)}),b.on("change",".wpforms-field-option-row-choices_images_style select",function(){var e=h(this).parent().data("field-id"),i=h("#wpforms-field-option-"+e).find(".wpforms-field-option-hidden-type").val();v.fieldChoiceUpdate(i,e)}),b.on("keyup",".wpforms-field-option-row-choices input.label, .wpforms-field-option-row-choices input.value",function(e){var i=h(this).parent().parent();v.fieldChoiceUpdate(i.data("field-type"),i.data("field-id"))}),b.on("click",".toggle-bulk-add-display",function(e){e.preventDefault(),v.fieldChoiceBulkAddToggle(this)}),b.on("click",".toggle-bulk-add-presets",function(e){e.preventDefault();e=h(this).closest(".bulk-add-display").find("ul");"block"===e.css("display")?h(this).text(wpforms_builder.bulk_add_presets_show):h(this).text(wpforms_builder.bulk_add_presets_hide),e.stop().slideToggle()}),b.on("click",".bulk-add-preset-insert",function(e){e.preventDefault();var i=h(this),o=i.data("preset"),t=i.closest(".bulk-add-display"),e=t.find("ul"),i=t.find(".toggle-bulk-add-presets"),t=t.find("textarea");t.val(""),t.insertAtCaret(wpforms_preset_choices[o].choices.join("\n")),i.text(wpforms_builder.bulk_add_presets_show),e.slideUp()}),b.on("click",".bulk-add-insert",function(e){e.preventDefault(),v.fieldChoiceBulkAddInsert(this)}),b.on("click",".wpforms-field-option-group-toggle:not(.education-modal)",function(e){e.preventDefault();e=h(this).closest(".wpforms-field-option-group");e.siblings(".wpforms-field-option-group").removeClass("active"),e.addClass("active")}),b.on("change",".wpforms-field-option-address input.wpforms-subfield-hide",function(e){var i=h(this).closest(".wpforms-field-option-row"),o=i.data("field-id"),i=i.data("subfield");h("#wpforms-field-"+o).find(".wpforms-"+i).toggleClass("wpforms-hide")}),b.on("input",".wpforms-field-option-row-label input, .wpforms-field-option-row-name input",function(e){var i=h(this),o=i.val(),t=i.parent().data("field-id"),r=h("#wpforms-field-"+t),i=r.data("field-type"),t=0===o.length;(t="html"===i?!1:t)&&(o=wpforms_builder.empty_label),r.toggleClass("label_empty",t).find(".label-title .text").text(o)}),b.on("input",".wpforms-field-option-row-description textarea",function(){var e=h(this),i=wpf.sanitizeHTML(e.val()),e=e.parent().data("field-id"),e=h("#wpforms-field-"+e).find(".description");v.updateDescription(e,i)}),b.on("change",".wpforms-field-option-row-required input",function(e){var i=h(this).closest(".wpforms-field-option-row").data("field-id");h("#wpforms-field-"+i).toggleClass("required")}),b.on("change",".wpforms-field-option-row-confirmation input",function(e){var i=h(this).closest(".wpforms-field-option-row").data("field-id");h("#wpforms-field-"+i).find(".wpforms-confirm").toggleClass("wpforms-confirm-enabled wpforms-confirm-disabled"),h("#wpforms-field-option-"+i).toggleClass("wpforms-confirm-enabled wpforms-confirm-disabled")}),b.on("change",".wpforms-field-option-row-filter_type select",function(){var e=h(this).parent().data("field-id"),e=h("#wpforms-field-option-"+e);h(this).val()?(e.removeClass("wpforms-filter-allowlist"),e.removeClass("wpforms-filter-denylist"),e.addClass("wpforms-filter-"+h(this).val())):(e.removeClass("wpforms-filter-allowlist"),e.removeClass("wpforms-filter-denylist"))}),b.on("focusout",".wpforms-field-option-row-allowlist textarea,.wpforms-field-option-row-denylist textarea",function(){var i=h(this);h.get(wpforms_builder.ajax_url,{nonce:wpforms_builder.nonce,content:i.val(),action:"wpforms_sanitize_restricted_rules"},function(e){e.success&&i.val(e.data)})}),b.on("change",".wpforms-field-option-row-size select",function(e){var i=h(this),o=i.val(),i=i.parent().data("field-id");h("#wpforms-field-"+i).removeClass("size-small size-medium size-large").addClass("size-"+o)}),b.on("input",".wpforms-field-option-row-placeholder input",function(){var e,i=h(this),o=wpf.sanitizeHTML(i.val()),t=i.parent().data("field-id"),r=h("#wpforms-field-"+t+" .primary-input");r.is("select")?v.dropdownField.helpers.isModernSelect(r)?(i=v.dropdownField.helpers.getInstance(r),r.prop("multiple")?h(i.input.element).prop("placeholder",o):(i.setChoiceByValue(""),r.closest(".choices").find(".choices__inner .choices__placeholder").text(o),e=h("#wpforms-field-option-"+t+"-dynamic_choices").val(),v.dropdownField.helpers.update(t,e))):(e=r.find(".placeholder"),!o.length&&e.length?e.remove():(e.length?e.text(o):r.prepend('<option value="" class="placeholder">'+o+"</option>"),r.find(".placeholder").prop("selected",!r.prop("multiple")))):r.prop("placeholder",o)}),b.on("input",".wpforms-field-option-row-confirmation_placeholder input",function(e){var i=h(this),o=i.val(),i=i.parent().data("field-id");h("#wpforms-field-"+i).find(".secondary-input").attr("placeholder",o)}),b.on("change",".wpforms-field-option-row-label_hide input",function(e){var i=h(this).closest(".wpforms-field-option-row").data("field-id");h("#wpforms-field-"+i).toggleClass("label_hide")}),b.on("change",".wpforms-field-option-row-sublabel_hide input",function(e){var i=h(this).closest(".wpforms-field-option-row").data("field-id");h("#wpforms-field-"+i).toggleClass("sublabel_hide")}),b.on("change",".wpforms-field-option-row-format select",function(){var e=h(this),i=e.val(),o=e.parent().data("field-id"),e=h("#wpforms-field-option-row-"+o+"-sublabel_hide");h("#wpforms-field-"+o).find(".format-selected").removeClass().addClass("format-selected format-selected-"+i),h("#wpforms-field-option-"+o).find(".format-selected").removeClass().addClass("format-selected format-selected-"+i),["date-time","first-last","first-middle-last"].includes(i)?e.removeClass("wpforms-hidden"):e.addClass("wpforms-hidden")}),b.on("change",".wpforms-field-option-row-scheme select",function(e){var i=h(this),o=i.val(),t=i.parent().data("field-id"),i=h("#wpforms-field-"+t);i.find(".wpforms-address-scheme").addClass("wpforms-hide"),i.find(".wpforms-address-scheme-"+o).removeClass("wpforms-hide"),0==i.find(".wpforms-address-scheme-"+o+" .wpforms-country").children().length?h("#wpforms-field-option-"+t).find(".wpforms-field-option-row-country").addClass("wpforms-hidden"):h("#wpforms-field-option-"+t).find(".wpforms-field-option-row-country").removeClass("wpforms-hidden")}),b.on("input",".wpforms-field-option .format-selected input.placeholder, .wpforms-field-option-address input.placeholder",function(e){var i=h(this),o=i.val(),t=i.closest(".wpforms-field-option-row"),i=t.data("field-id"),t=t.data("subfield");h("#wpforms-field-"+i).find(".wpforms-"+t+" input").attr("placeholder",o)}),b.on("change",".wpforms-field-option-row-date .type select",function(e){var i=h(this),o=i.val(),t=h(this).closest(".wpforms-field-option-row").data("field-id"),r="datepicker"===o?"wpforms-date-type-datepicker":"wpforms-date-type-dropdown",s="datepicker"===o?"wpforms-date-type-dropdown":"wpforms-date-type-datepicker";h("#wpforms-field-"+t).find(".wpforms-date").addClass(r).removeClass(s),h("#wpforms-field-option-"+t).addClass(r).removeClass(s);s=i.closest(".wpforms-field-option-group-advanced").find(".wpforms-field-option-row-date_limit_days, .wpforms-field-option-row-date_limit_days_options, .wpforms-field-option-row-date_disable_past_dates"),i=h("#wpforms-field-option-row-"+t+"-date_limit_days_options");"dropdown"===o?((o=h("#wpforms-field-option-"+t+"-date_format")).find("option:selected").hasClass("datepicker-only")&&o.prop("selectedIndex",0).trigger("change"),s.hide()):(s.show(),h("#wpforms-field-option-"+t+"-date_limit_days").is(":checked")?i.show():i.hide())}),b.on("change",".wpforms-field-option-row-date .format select",function(e){var i=h(this).val(),o=h(this).closest(".wpforms-field-option-row").data("field-id"),o=h("#wpforms-field-"+o);"m/d/Y"===i?(o.find(".wpforms-date-dropdown .first option").text(wpforms_builder.date_select_month),o.find(".wpforms-date-dropdown .second option").text(wpforms_builder.date_select_day)):"d/m/Y"===i&&(o.find(".wpforms-date-dropdown .first option").text(wpforms_builder.date_select_day),o.find(".wpforms-date-dropdown .second option").text(wpforms_builder.date_select_month))}),b.on("change",".wpforms-field-option-row-time .format select",function(e){for(var i=h(this),r=h(this).closest(".wpforms-field-option-row").data("field-id"),s="",n=i.val().match(/[gh]/)?12:24,o=0;o<n;o++)s+='<option value="{hh}">{hh}</option>'.replace(/{hh}/g,o<10?"0"+o:o);_.forEach(["start","end"],function(e){var i=b.find("#wpforms-field-option-"+r+"-time_limit_hours_"+e+"_hour"),o=b.find("#wpforms-field-option-"+r+"-time_limit_hours_"+e+"_ampm"),t=parseInt(i.val(),10),e=o.val();t=(t=24==n?"pm"===e?t+12:t:(e=12<t?"pm":"am",12<t?t-12:t))<10?"0"+t:t,i.html(s).val(t),o.toggleClass("wpforms-hidden-strict",24==n).val(e),o.nextAll("div").toggleClass("wpforms-hidden-strict",12==n)})}),b.on("click",".wpforms-pagebreak-button",function(e){e.preventDefault(),h(this).closest(".wpforms-field").trigger("click")}),v.fieldPageBreakInitDisplayPrevious(b.find(".wpforms-field-pagebreak.wpforms-pagebreak-normal:first")),b.on("input",".wpforms-field-option-row-next input",function(e){var i=h(this),o=i.val(),i=h("#wpforms-field-"+i.parent().data("field-id")).find(".wpforms-pagebreak-next");o?i.css("display","inline-block").text(o):i.css("display","none").empty()}).on("input",".wpforms-field-option-row-prev input",function(e){var i=h(this),o=i.val().trim(),t=h("#wpforms-field-"+i.parent().data("field-id")),i=t.find(".wpforms-pagebreak-prev");o&&0<t.prevAll(".wpforms-field-pagebreak.wpforms-pagebreak-normal").length?i.removeClass("wpforms-hidden").text(o):i.addClass("wpforms-hidden").empty()}).on("change",".wpforms-field-option-row-prev_toggle input",function(e){var i=h(this),o=i.closest(".wpforms-field-option-row-prev_toggle"),t=i.closest(".wpforms-field-option-group-inner").find(".wpforms-field-option-row-prev"),r=t.find("input"),s=h("#wpforms-field-"+i.closest(".wpforms-field-option").data("field-id")).find(".wpforms-pagebreak-prev");o.hasClass("wpforms-entry-preview-block")||(t.toggleClass("wpforms-hidden",!i.prop("checked")),s.toggleClass("wpforms-hidden",!i.prop("checked")),i.prop("checked")&&!r.val()&&(s=(s=r.data("last-value"))&&s.trim()?s.trim():wpforms_builder.previous,r.val(s)),i.prop("checked")||(r.data("last-value",r.val()),r.val("")),r.trigger("input"))}).on("wpformsFieldAdd",v.fieldPagebreakAdd).on("wpformsFieldDelete",v.fieldPagebreakDelete).on("wpformsBeforeFieldDelete",v.fieldEntryPreviewDelete),b.on("wpformsFieldMove wpformsFieldAdd wpformsFieldDelete",function(e){b.find(".wpforms-field-pagebreak.wpforms-pagebreak-normal").each(function(e){v.fieldPageBreakInitDisplayPrevious(h(this))})}),b.on("input",".wpforms-field-option-row-title input",function(e){var i=h(this),o=i.val(),i=i.parent().data("field-id");o?h("#wpforms-field-"+i).find(".wpforms-pagebreak-title").text("("+o+")"):h("#wpforms-field-"+i).find(".wpforms-pagebreak-title").empty()}),b.on("change",".wpforms-field-option-row-nav_align select",function(e){var i=(i=h(this).val())||"center";h(".wpforms-pagebreak-buttons").removeClass("wpforms-pagebreak-buttons-center wpforms-pagebreak-buttons-left wpforms-pagebreak-buttons-right wpforms-pagebreak-buttons-split").addClass("wpforms-pagebreak-buttons-"+i)}),b.on("input",".wpforms-field-option-row-price input",function(e){var i=h(this),o=i.val(),t=i.parent().data("field-id"),i=wpf.amountSanitize(o),o=wpf.amountFormat(i),i="right"===wpforms_builder.currency_symbol_pos?o+" "+wpforms_builder.currency_symbol:wpforms_builder.currency_symbol+" "+o;h("#wpforms-field-"+t).find(".primary-input").val(o),h("#wpforms-field-"+t).find(".price").text(i)}),b.on("change",".wpforms-field-option-credit-card .payment-icons input",function(e){var i=h(this),o=i.data("card"),i=i.parent().data("field-id");h("#wpforms-field-"+i).find("img.icon-"+o).toggleClass("card_hide")}),b.on("input",".wpforms-field-option input.placeholder-update",function(e){var i=h(this),o=i.val(),t=i.data("field-id"),i=i.data("subfield");h("#wpforms-field-"+t).find(".wpforms-"+i+" input").attr("placeholder",o)}),b.on("change",".wpforms-field-option-row-input_columns select",function(){var e=h(this),i=e.val(),o="",e=e.parent().data("field-id");"2"===i?o="wpforms-list-2-columns":"3"===i?o="wpforms-list-3-columns":"inline"===i&&(o="wpforms-list-inline"),h("#wpforms-field-"+e).removeClass("wpforms-list-2-columns wpforms-list-3-columns wpforms-list-inline").addClass(o)}),b.on("change",".wpforms-field-option-row .wpforms-toggle-control input",function(e){var i=h(this),o=i.closest(".wpforms-toggle-control").find(".wpforms-toggle-control-status"),i=i.is(":checked")?"on":"off";o.html(o.data(i))}),b.on("change",".wpforms-field-option-row-dynamic_choices select",function(e){v.fieldDynamicChoiceToggle(h(this))}),b.on("change",".wpforms-field-option-row-dynamic_taxonomy select, .wpforms-field-option-row-dynamic_post_type select",function(e){v.fieldDynamicChoiceSource(h(this))}),b.on("click",".toggle-layout-selector-display",function(e){e.preventDefault(),v.fieldLayoutSelectorToggle(this)}),b.on("click",".layout-selector-display-layout",function(e){e.preventDefault(),v.fieldLayoutSelectorLayout(this)}),b.on("click",".layout-selector-display-columns span",function(e){e.preventDefault(),v.fieldLayoutSelectorInsert(this)}),h(r).on("change",".wpforms-field-option-row-scale select",function(){var e=h(this),i=e.val(),e=e.parent().data("field-id"),e=h("#wpforms-field-"+e+" .rating-icon"),o=1;e.each(function(e){o<=i?h(this).show():h(this).hide(),o++})}),h(r).on("change",".wpforms-field-option-row-icon select",function(){var e=h(this),i=e.val(),o=e.parent().data("field-id"),e="fa-star";"heart"===i?e="fa-heart":"thumb"===i?e="fa-thumbs-up":"smiley"===i&&(e="fa-smile-o"),h("#wpforms-field-"+o+" .rating-icon").removeClass("fa-star fa-heart fa-thumbs-up fa-smile-o").addClass(e)}),h(r).on("change",".wpforms-field-option-row-icon_size select",function(){var e=h(this),i=e.val(),e=e.parent().data("field-id"),e=h("#wpforms-field-"+e+" .rating-icon");fontSize="28","small"===i?fontSize="18":"large"===i&&(fontSize="38"),e.css("font-size",fontSize+"px")}),h(r).on("input",".wpforms-field-option-row-icon_color input.wpforms-color-picker",function(){var e=h(this),i=e.val(),e=e.closest(".wpforms-field-option-row").data("field-id");h("#wpforms-field-"+e+" > i.fa").css("color",i)}),h(r).on("change",".wpforms-field-option-row-disclaimer_format input",function(){var e=h(this).closest(".wpforms-field-option-row").data("field-id");h("#wpforms-field-"+e+" .description").toggleClass("disclaimer")}),b.on("change",".wpforms-field-option-row-limit_enabled input",function(e){v.updateTextFieldsLimitControls(h(e.target).closest(".wpforms-field-option-row-limit_enabled").data().fieldId,e.target.checked)}),b.on("change",".wpforms-field-option-row-password-strength input",function(e){v.updatePasswordStrengthControls(h(e.target).parents(".wpforms-field-option-row-password-strength").data().fieldId,e.target.checked)}),b.on("change",".wpforms-field-option-richtext .wpforms-field-option-row-media_enabled input",v.updateRichTextMediaFieldsLimitControls),b.on("change",".wpforms-field-option-richtext .wpforms-field-option-row-style select",v.updateRichTextStylePreview),b.on("change",".wpforms-field-option-file-upload .wpforms-field-option-row-style select, .wpforms-field-option-file-upload .wpforms-field-option-row-max_file_number input",function(e){v.fieldFileUploadPreviewUpdate(e.target)}),v.numberSliderEvents(b),v.fieldDynamicChoiceToggleImageChoices(),b.on("change",".wpforms-field-option-row-show_price_after_labels input",function(e){var i=h(this).closest(".wpforms-field-option-group-basic").find(".wpforms-field-option-row-choices .choices-list");v.fieldChoiceUpdate(i.data("field-type"),i.data("field-id"))}),b.on("input",".wpforms-field-option-row-preview-notice textarea",v.updatePreviewNotice).on("change",".wpforms-field-option-row-preview-notice-enable input",v.toggleEntryPreviewNotice).on("wpformsFieldAdd",v.maybeLockEntryPreviewGroupOnAdd).on("wpformsFieldMove",v.maybeLockEntryPreviewGroupOnMove).on("click",".wpforms-entry-preview-block",v.entryPreviewBlockField),v.defaultStateEntryPreviewNotice()},isFieldPreviewActionsDisabled:function(e){return h(e).closest(".wpforms-field-wrap").hasClass("ui-sortable-disabled")},fieldGroupToggle:function(e,i){var o=h(e),t=o.next(".wpforms-add-fields-buttons"),r=t.parent(),s=o.find("i"),e="wpforms_field_group_"+o.data("group");if("click"===i)return r.hasClass("wpforms-closed")?wpCookies.remove(e):wpCookies.set(e,"true",2592e3),s.toggleClass("wpforms-angle-right"),void t.stop().slideToggle("",function(){r.toggleClass("wpforms-closed")});"load"===i&&(t=o.find(".wpforms-add-fields-buttons"),s=o.find(".wpforms-add-fields-heading i"),e="wpforms_field_group_"+o.find(".wpforms-add-fields-heading").data("group"),"true"===wpCookies.get(e)&&(s.toggleClass("wpforms-angle-right"),t.hide(),o.toggleClass("wpforms-closed")))},updateDescription:function(e,i){e.hasClass("nl2br")&&(i=i.replace(/\n/g,"<br>")),e.html(i)},defaultStateEntryPreviewNotice:function(){h(".wpforms-field-option-row-preview-notice-enable input").each(function(){h(this).trigger("change")})},updatePreviewNotice:function(){var e=h(this),i=wpf.sanitizeHTML(e.val()).trim(),e=e.parent().data("field-id"),e=h("#wpforms-field-"+e).find(".wpforms-entry-preview-notice"),i=i||wpforms_builder.entry_preview_default_notice;v.updateDescription(e,i)},toggleEntryPreviewNotice:function(){var e=h(this),i=e.closest(".wpforms-field-option").data("field-id"),o=h("#wpforms-field-"+i),t=h("#wpforms-field-option-"+i+" .wpforms-field-option-row-preview-notice"),i=o.find(".wpforms-entry-preview-notice"),o=o.find(".wpforms-alert-info");if(e.is(":checked"))return o.hide(),i.show(),void t.show();t.hide(),i.hide(),o.show()},fieldDelete:function(e){var i=h("#wpforms-field-"+e),o=i.data("field-type");"pagebreak"===o&&i.hasClass("wpforms-field-entry-preview-not-deleted")?v.youCantRemovePageBreakFieldPopup():i.hasClass("no-delete")?v.youCantRemoveFieldPopup():v.confirmFieldDeletion(e,o)},youCantRemovePageBreakFieldPopup:function(){h.alert({title:wpforms_builder.heads_up,content:wpforms_builder.entry_preview_require_page_break,icon:"fa fa-exclamation-circle",type:"red",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},youCantReorderFieldPopup:function(){h.confirm({title:wpforms_builder.heads_up,content:wpforms_builder.field_cannot_be_reordered,icon:"fa fa-exclamation-circle",type:"red",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},youCantRemoveFieldPopup:function(){h.alert({title:wpforms_builder.field_locked,content:wpforms_builder.field_locked_no_delete_msg,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:wpforms_builder.close,btnClass:"btn-confirm",keys:["enter"]}}})},confirmFieldDeletion:function(e,i){var o={id:e,message:wpforms_builder.delete_confirm};b.trigger("wpformsBeforeFieldDeleteAlert",[o]),h.confirm({title:!1,content:o.message,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){v.fieldDeleteById(e,i)}},cancel:{text:wpforms_builder.cancel}}})},fieldDeleteById:function(e,i){h("#wpforms-field-"+e).fadeOut(400,function(){b.trigger("wpformsBeforeFieldDelete",[e,i]),h(this).remove(),h("#wpforms-field-option-"+e).remove(),h(".wpforms-field, .wpforms-title-desc").removeClass("active"),v.fieldTabToggle("add-fields"),h(".wpforms-field").length<1&&(p.$fieldOptions.append(p.$noFieldsOptions.clone()),p.$sortableFieldsWrap.append(p.$noFieldsPreview.clone()),b.find(".wpforms-field-submit").hide()),b.trigger("wpformsFieldDelete",[e,i])})},loadEntryPreviewFields:function(){var e=h("#wpforms-panel-fields .wpforms-field-wrap .wpforms-field-entry-preview");e.length&&e.each(function(){v.lockEntryPreviewFieldsPosition(h(this).data("field-id"))})},fieldEntryPreviewDelete:function(e,i,o){"entry-preview"===o&&(i=(o=h("#wpforms-field-"+i)).prevAll(".wpforms-field-pagebreak").first(),o=o.nextAll(".wpforms-field-pagebreak").first().data("field-id"),o=h("#wpforms-field-option-"+o),i.removeClass("wpforms-field-not-draggable wpforms-field-entry-preview-not-deleted"),o.find(".wpforms-entry-preview-block").removeClass("wpforms-entry-preview-block"))},maybeLockEntryPreviewGroupOnMove:function(e,i){i.item.hasClass("wpforms-field-pagebreak")&&v.maybeLockEntryPreviewGroupOnAdd(e,i.item.data("field-id"),"pagebreak")},maybeLockEntryPreviewGroupOnAdd:function(e,i,o){if("pagebreak"===o){var t=h("#wpforms-field-"+i),r=h("#wpforms-field-option-"+i+" .wpforms-field-option-row-prev_toggle"),s=r.find("input"),n=t.prevAll(".wpforms-field-entry-preview,.wpforms-field-pagebreak").first(),a=h("#wpforms-field-option-"+n.data("field-id")+" .wpforms-field-option-row-prev_toggle"),l=a.find("input"),o=t.nextAll(".wpforms-field-entry-preview,.wpforms-field-pagebreak").first(),i=h("#wpforms-field-option-"+o.data("field-id")+" .wpforms-field-option-row-prev_toggle");if(n.hasClass("wpforms-field-entry-preview")||o.hasClass("wpforms-field-entry-preview")){if(n.hasClass("wpforms-field-entry-preview"))return s.attr("checked","checked").trigger("change"),r.addClass("wpforms-entry-preview-block"),void i.removeClass("wpforms-entry-preview-block");t.addClass("wpforms-field-not-draggable wpforms-field-entry-preview-not-deleted"),n.removeClass("wpforms-field-not-draggable wpforms-field-entry-preview-not-deleted"),n.prevAll(".wpforms-field-entry-preview,.wpforms-field-pagebreak").first().hasClass("wpforms-field-entry-preview")&&(l.attr("checked","checked").trigger("change"),a.addClass("wpforms-entry-preview-block"))}}},entryPreviewBlockField:function(e){e.preventDefault(),h.alert({title:wpforms_builder.heads_up,content:wpforms_builder.entry_preview_require_previous_button,icon:"fa fa-exclamation-circle",type:"red",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},isUncheckedEntryPreviewField:function(e,i){return!("entry-preview"!==e||i&&i.passed)},addEntryPreviewField:function(e,i){var o,t,r,s=h("#wpforms-add-fields-entry-preview");s.hasClass("wpforms-entry-preview-adding")||(r=h("#wpforms-panel-fields .wpforms-field-wrap .wpforms-field"),o=i&&i.position?i.position:r.length,t=v.isEntryPreviewFieldRequiresPageBreakBefore(r,o),r=v.isEntryPreviewFieldRequiresPageBreakAfter(r,o),s.addClass("wpforms-entry-preview-adding"),(i=i||{}).passed=!0,t||r?t?v.addPageBreakAndEntryPreviewFields(i,o):v.addEntryPreviewAndPageBreakFields(i,o):v.fieldAdd("entry-preview",i).done(function(e){v.lockEntryPreviewFieldsPosition(e.data.field.id)}))},addEntryPreviewFieldAfterPageBreak:function(e){var i=setInterval(function(){2===h("#wpforms-panel-fields .wpforms-field-wrap").find(".wpforms-pagebreak-bottom, .wpforms-pagebreak-top").length&&(v.fieldAdd("entry-preview",e).done(function(e){v.lockEntryPreviewFieldsPosition(e.data.field.id)}),clearInterval(i))},100)},addPageBreakAndEntryPreviewFields:function(i,o){var t=3<=h("#wpforms-panel-fields .wpforms-field-wrap .wpforms-field-pagebreak").length;v.fieldAdd("pagebreak",{position:o}).done(function(e){i.position=t?o+1:o+2,v.addEntryPreviewFieldAfterPageBreak(i);e=h("#wpforms-field-option-"+e.data.field.id).find(".wpforms-field-option-row-prev_toggle");e.find("input").attr("checked","checked").trigger("change"),e.addClass("wpforms-entry-preview-block")})},fieldDuplicate:function(m){var u=h("#wpforms-field-"+m),w=u.data("field-type");u.hasClass("no-duplicate")?h.alert({title:wpforms_builder.field_locked,content:wpforms_builder.field_locked_no_duplicate_msg,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:wpforms_builder.close,btnClass:"btn-confirm",keys:["enter"]}}}):h.confirm({title:!1,content:wpforms_builder.duplicate_confirm,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){var e=h("#wpforms-field-option-"+m),i=v.dropdownField.helpers.isModernSelect(u.find(".primary-input"));wpf.restoreTooltips(e),i&&v.dropdownField.helpers.convertModernToClassic(m);var o=u.clone(),t=e.html(),n=h("#wpforms-field-id").val(),r=h("#wpforms-field-option-"+m+"-label").length?h("#wpforms-field-option-"+m+"-label"):h("#wpforms-field-option-"+m+"-name"),s=r.length?r.val()+" "+wpforms_builder.duplicate_copy:wpforms_builder.field+" #"+m+" "+wpforms_builder.duplicate_copy,a=Number(n)+1,l=new RegExp("ID #"+m,"g"),d=new RegExp("fields\\["+m+"\\]","g"),f=new RegExp('data-field-id="'+m+'"',"g"),p=new RegExp('data-reference="'+m+'"',"g"),r=new RegExp('\\b(id|for)="wpforms-(.*?)'+m+'(.*?)"',"ig");u.after(o),u.removeClass("active"),o.addClass("active").attr({id:"wpforms-field-"+n,"data-field-id":n}),t=(t=(t=(t=(t=t.replace(l,"ID #"+n)).replace(d,"fields["+n+"]")).replace(f,'data-field-id="'+n+'"')).replace(p,'data-reference="'+n+'"')).replace(r,function(e,i,o,t,r,s){return i+'="wpforms-'+o+n+t+'"'}),e.hide().after('<div class="'+e.attr("class")+'" id="wpforms-field-option-'+n+'" data-field-id="'+n+'">'+t+"</div>");var c=h("#wpforms-field-option-"+n);e.find(":input").each(function(e,i){var o=h(this),t=o.attr("name");if(!t)return"continue";var r=t.replace(d,"fields["+n+"]"),t=o.attr("type");"checkbox"===t||"radio"===t?o.is(":checked")?c.find('[name="'+r+'"]').prop("checked",!0).attr("checked","checked"):c.find('[name="'+r+'"]').prop("checked",!1).attr("checked",!1):o.is("select")?o.find("option:selected").length&&(t=o.find("option:selected").val(),c.find('[name="'+r+'"]').find('[value="'+t+'"]').prop("selected",!0)):""!==o.val()?c.find('[name="'+r+'"]').val(o.val()):o.hasClass("wpforms-money-input")&&c.find('[name="'+r+'"]').val(wpf.numberFormat("0",wpforms_builder.currency_decimals,wpforms_builder.currency_decimal,wpforms_builder.currency_thousands))}),h("#wpforms-field-option-"+n).find(".wpforms-field-option-hidden-id").val(n),h("#wpforms-field-id").val(a),h("#wpforms-field-option-"+n+"-label").val(s),"html"===w&&h("#wpforms-field-option-"+n+"-name").val(s),o.find(".label-title .text").text(s),b.trigger("wpformsFieldAdd",[n,w]),wpf.initTooltips(),i&&(v.dropdownField.helpers.convertClassicToModern(m),v.dropdownField.helpers.convertClassicToModern(n)),v.fieldChoiceUpdate(o.data("field-type"),n),h.post(wpforms_builder.ajax_url,{form_id:g.formID,nonce:wpforms_builder.nonce,action:"wpforms_builder_increase_next_field_id"})}},cancel:{text:wpforms_builder.cancel}}})},addEntryPreviewAndPageBreakFields:function(e,o){v.fieldAdd("entry-preview",e).done(function(e){var i=e.data.field.id;v.fieldAdd("pagebreak",{position:o+1}).done(function(){v.lockEntryPreviewFieldsPosition(i)})})},lockEntryPreviewFieldsPosition:function(e){var i=h("#wpforms-field-"+e),o=i.prevAll(".wpforms-field-pagebreak:not(.wpforms-pagebreak-bottom)").first(),t=i.nextAll(".wpforms-field-pagebreak").first().data("field-id"),e=h("#wpforms-field-option-"+t).find(".wpforms-field-option-row-prev_toggle"),t=e.find("input");i.addClass("wpforms-field-not-draggable"),o.addClass("wpforms-field-not-draggable wpforms-field-entry-preview-not-deleted"),t.attr("checked","checked").trigger("change"),e.addClass("wpforms-entry-preview-block"),h("#wpforms-add-fields-entry-preview").removeClass("wpforms-entry-preview-adding")},isEntryPreviewFieldRequiresPageBreakBefore:function(e,i){var i=e.slice(0,i).filter(".wpforms-field-pagebreak,.wpforms-field-entry-preview"),o=!0;return i.length&&h(i.get().reverse()).each(function(){var e=h(this);return!e.hasClass("wpforms-field-entry-preview")&&(e.hasClass("wpforms-field-pagebreak")&&!e.hasClass("wpforms-field-stick")?o=!1:void 0)}),o},isEntryPreviewFieldRequiresPageBreakAfter:function(e,i){var i=e.slice(i).filter(".wpforms-field-pagebreak,.wpforms-field-entry-preview"),o=Boolean(i.length);return i.length&&i.each(function(){var e=h(this);return!e.hasClass("wpforms-field-entry-preview")&&(e.hasClass("wpforms-field-pagebreak")?o=!1:void 0)}),o},fieldAdd:function(n,a){var e=h("#wpforms-add-fields-"+n);if(!(e.hasClass("upgrade-modal")||e.hasClass("education-modal")||e.hasClass("warning-modal")))if(-1===h.inArray(n,["captcha_hcaptcha","captcha_recaptcha","captcha_none"])){if(l=!0,v.disableDragAndDrop(),v.disableFormActions(),!v.isUncheckedEntryPreviewField(n,a)){a=h.extend({},{position:"bottom",placeholder:!1,scroll:!0,defaults:!1},a);e={action:"wpforms_new_field_"+n,id:g.formID,type:n,defaults:a.defaults,nonce:wpforms_builder.nonce};return h.post(wpforms_builder.ajax_url,e,function(e){var i,o,t,r,s;e.success?(i=(r=h("#wpforms-panel-fields .wpforms-field")).last(),o=r.length,t=h("#wpforms-panel-fields .wpforms-panel-content-wrap"),s=h(e.data.preview),r=h(e.data.options),l=!1,s.css("display","none"),a.placeholder&&a.placeholder.remove(),"bottom"===a.position?i.length&&i.hasClass("wpforms-field-stick")?(h("#wpforms-panel-fields .wpforms-field-wrap").children(":eq("+(o-1)+")").before(s),h("#wpforms-panel-fields .wpforms-field-options").children(":eq("+(o-1)+")").before(r)):(h("#wpforms-panel-fields .wpforms-field-wrap").append(s),h("#wpforms-panel-fields .wpforms-field-options").append(r)):"top"===a.position?(h("#wpforms-panel-fields .wpforms-field-wrap").prepend(s),h("#wpforms-panel-fields .wpforms-field-options").prepend(r)):a.position===o&&i.length&&i.hasClass("wpforms-field-stick")?(h("#wpforms-panel-fields .wpforms-field-wrap").children(":eq("+(o-1)+")").before(s),h("#wpforms-panel-fields .wpforms-field-options").children(":eq("+(o-1)+")").before(r)):h("#wpforms-panel-fields .wpforms-field-wrap").find(".wpforms-field").eq(a.position).length?(h("#wpforms-panel-fields .wpforms-field-wrap").find(".wpforms-field").eq(a.position).before(s),h("#wpforms-panel-fields .wpforms-field-options").find(".wpforms-field-option").eq(a.position).before(r)):(h("#wpforms-panel-fields .wpforms-field-wrap").append(s),h("#wpforms-panel-fields .wpforms-field-options").append(r)),s.fadeIn(),b.find(".no-fields, .no-fields-preview").remove(),b.find(".wpforms-field-submit").show(),a.scroll&&a.position.length&&(r=t.scrollTop(),s=s.position().top,t.animate({scrollTop:"bottom"===a.position?r<s?s-r:s+r:0},1e3)),h("#wpforms-field-id").val(e.data.field.id+1),wpf.initTooltips(),v.loadColorPickers(),v.toggleAllOptionGroups(),b.trigger("wpformsFieldAdd",[e.data.field.id,n])):console.log(e)}).fail(function(e,i,o){l=!1,console.log(e.responseText)}).always(function(){b.find(".wpforms-add-fields .wpforms-add-fields-button").prop("disabled",!1),l||(v.enableDragAndDrop(),v.enableFormActions())})}v.addEntryPreviewField(n,a)}else v.captchaUpdate()},captchaUpdate:function(){var e={action:"wpforms_update_field_captcha",id:g.formID,nonce:wpforms_builder.nonce};return h.post(wpforms_builder.ajax_url,e,function(e){var i,o,t;e.success?(i={title:!1,content:!1,icon:"fa fa-exclamation-circle",type:"orange",boxWidth:"450px",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}},o=h("#wpforms-panel-field-settings-recaptcha"),t=e.data.current,o.data("provider",e.data.provider),"configured_not_enabled"!==t&&"configured_enabled"!==t||(t=o.prop("checked")?"configured_enabled":"configured_not_enabled",i.buttons.confirm.action=function(){o.prop("checked","configured_not_enabled"===t).trigger("change")}),i.title=e.data.cases[t].title,i.content=e.data.cases[t].content,e.data.cases[t].cancel&&(i.buttons.cancel={text:wpforms_builder.cancel,keys:["esc"]}),h.confirm(i)):console.log(e)}).fail(function(e,i,o){console.log(e.responseText)})},disableDragAndDrop:function(){p.$addFieldsButtons.filter(".ui-draggable").draggable("disable"),p.$sortableFieldsWrap.filter(".ui-sortable").sortable("disable")},enableDragAndDrop:function(){p.$addFieldsButtons.filter(".ui-draggable").draggable("enable"),p.$sortableFieldsWrap.filter(".ui-sortable").sortable("enable")},disableFormActions:function(){h.each([p.$previewButton,p.$embedButton,p.$saveButton,p.$exitButton],function(e,i){i.prop("disabled",!0).addClass("wpforms-disabled")})},enableFormActions:function(){h.each([p.$previewButton,p.$embedButton,p.$saveButton,p.$exitButton],function(e,i){i.prop("disabled",!1).removeClass("wpforms-disabled")})},fieldSortable:function(){var o,t,r,s,n,a=h(".wpforms-field-options"),l=!1,d=h("#wpforms-panel-fields .wpforms-panel-content-wrap"),f=!1;p.$sortableFieldsWrap.sortable({items:"> .wpforms-field:not(.wpforms-field-stick):not(.no-fields-preview)",axis:"y",delay:100,opacity:.75,cursor:"move",start:function(e,i){o=i.item.index(),r=a[0].children[o]},stop:function(e,i){t=i.item.index(),s=a[0].children[t],o<t?h(s).after(r):h(s).before(r),b.trigger("wpformsFieldMove",i),l=!1},over:function(e,i){var o=i.item.first();o.addClass("wpforms-field-dragging"),o.hasClass("wpforms-field-drag")&&(i=h(".wpforms-field").outerWidth()||p.$sortableFieldsWrap.find(".no-fields-preview").outerWidth(),o.addClass("wpforms-field-drag-over").removeClass("wpforms-field-drag-out").css("width",i).css("height","auto"))},out:function(e,i){var o=i.item.first();o.removeClass("wpforms-field-dragging"),l||(i=o.attr("data-original-width"),o.hasClass("wpforms-field-drag")&&o.addClass("wpforms-field-drag-out").removeClass("wpforms-field-drag-over").css({width:i,left:"",top:""})),o.css({top:"",left:"","z-index":""})},receive:function(e,i){l=!0;var o=h(this).data("ui-sortable").currentItem.index(),t=i.helper,i=t.attr("data-field-type");t.addClass("wpforms-field-drag-over wpforms-field-drag-pending").removeClass("wpforms-field-drag-out").css("width","100%"),t.append(g.spinnerInline),b.find(".wpforms-add-fields .wpforms-add-fields-button").prop("disabled",!0),b.find(".no-fields-preview").remove(),v.fieldAdd(i,{position:o,placeholder:t})},sort:function(e,i){if(!f){var o,t=e.clientY,r=d.offset(),s=d.height(),e=r.top+s;if(t>r.top&&t<r.top+50)o="-=";else{if(!(e-50<t&&t<e))return;o="+="}f=!0,d.animate({scrollTop:o+s/3+"px"},800,function(){f=!1})}},cancel:".wpforms-field-not-draggable"}),h(".wpforms-field-not-draggable, .wpforms-field-stick").draggable({revert:!0,axis:"y",delay:100,opacity:.75,cursor:"move",start:function(e,i){n=i.position.top},drag:function(e,i){if(15<Math.abs(i.position.top)-Math.abs(n))return v.youCantReorderFieldPopup(),!1}}),h(".wpforms-add-fields-button").not(".not-draggable").not(".warning-modal").not(".education-modal").draggable({connectToSortable:".wpforms-field-wrap",delay:200,helper:function(){var e=h(this),i=e.outerWidth(),o=e.html(),e=e.data("field-type");return h('<div class="wpforms-field-drag-out wpforms-field-drag">').html(o).css("width",i).attr({"data-original-width":i,"data-field-type":e})},revert:"invalid",cancel:!1,scroll:!1,opacity:.75,containment:"document"}),p.$addFieldsButtons.draggable({connectToSortable:".wpforms-field-wrap",delay:200,helper:function(){var e=h(this),i=e.outerWidth(),o=e.html(),e=e.data("field-type");return h('<div class="wpforms-field-drag-out wpforms-field-drag">').html(o).css("width",i).attr({"data-original-width":i,"data-field-type":e})},revert:"invalid",cancel:!1,scroll:!1,opacity:.75,containment:"document"})},fieldChoiceAdd:function(e,i){e.preventDefault();var o=h(i),t=o.parent(),r=t.find("input.default").is(":checked"),s=o.closest(".wpforms-field-option-row-choices").data("field-id"),e=t.parent().attr("data-next-id"),i=t.parent().data("field-type"),o=t.clone().insertAfter(t);o.attr("data-key",e),o.find("input.label").val("").attr("name","fields["+s+"][choices]["+e+"][label]"),o.find("input.value").val("").attr("name","fields["+s+"][choices]["+e+"][value]"),o.find("input.source").val("").attr("name","fields["+s+"][choices]["+e+"][image]"),o.find("input.default").attr("name","fields["+s+"][choices]["+e+"][default]").prop("checked",!1),o.find(".preview").empty(),o.find(".wpforms-image-upload-add").show(),o.find(".wpforms-money-input").trigger("focusout"),!0===r&&t.find("input.default").prop("checked",!0),e++,t.parent().attr("data-next-id",e),b.trigger("wpformsFieldChoiceAdd"),v.fieldChoiceUpdate(i,s)},fieldChoiceDelete:function(e,i){e.preventDefault();var o,t=h(i),r=t.parent().parent(),e=r.find("li").length,i={id:r.data("field-id"),choiceId:t.closest("li").data("key"),message:"<strong>"+wpforms_builder.delete_choice_confirm+"</strong>",trigger:!1};b.trigger("wpformsBeforeFieldDeleteAlert",[i]),1===e?v.fieldChoiceDeleteAlert():(o=function(){t.parent().remove(),v.fieldChoiceUpdate(r.data("field-type"),r.data("field-id")),b.trigger("wpformsFieldChoiceDelete")},i.trigger?h.confirm({title:!1,content:i.message,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){o()}},cancel:{text:wpforms_builder.cancel}}}):o())},fieldChoiceDeleteAlert:function(){h.alert({title:!1,content:wpforms_builder.error_choice,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},fieldChoiceSortable:function(t,e){h(e=void 0!==e?e:".wpforms-field-option-"+t+" .wpforms-field-option-row-choices ul").sortable({items:"li",axis:"y",delay:100,opacity:.6,handle:".move",stop:function(e,i){var o=i.item.parent().data("field-id");v.fieldChoiceUpdate(t,o),b.trigger("wpformsFieldChoiceMove",i)},update:function(e,i){}})},fieldChoiceLabel:function(e,i){var o=void 0!==e.settings.choices[i].label&&0!==e.settings.choices[i].label.length?wpf.sanitizeHTML(e.settings.choices[i].label):wpforms_builder.choice_empty_label_tpl.replace("{number}",i);return e.settings.show_price_after_labels&&(o+=" - "+wpf.amountFormatCurrency(e.settings.choices[i].value)),o},fieldChoiceUpdate:function(s,e){var n=h("#wpforms-field-"+e+" .primary-input");if("radio"===s||"checkbox"===s||"payment-multiple"===s||"payment-checkbox"===s){var i=wpf.getField(e),o=wpf.getChoicesOrder(e),t={},r=o.slice(0,20),a=wp.template("wpforms-field-preview-checkbox-radio-payment-multiple"),l={settings:i,order:r,type:"radio"};return r.forEach(function(e){t[e]=i.choices[e]}),i.choices=t,"checkbox"!==s&&"payment-checkbox"!==s||(l.type="checkbox"),h("#wpforms-field-"+e).find("ul.primary-input").replaceWith(a(l)),void v.firstNChoicesAlert(e,o.length)}var d=v.dropdownField.helpers.isModernSelect(n),f="";"select"===(s="payment-select"===(s="payment-checkbox"===(s="payment-multiple"===s?"radio":s)?"checkbox":s)?"select":s)?(f='<option value="{label}">{label}</option>',n.find("option").not(".placeholder").remove()):"radio"!==s&&"checkbox"!==s&&"gdpr-checkbox"!==s||(s="gdpr-checkbox"===s?"checkbox":s,n.find("li").remove(),f='<li><input type="'+s+'" disabled>{label}</li>');var r=h("#wpforms-field-option-row-"+e+"-choices .choices-list"),a=r.find("li").slice(0,20),l=!!r.find("input.default:checked").length,p=[],c=h("#wpforms-field-option-"+e+"-show_price_after_labels").prop("checked");a.each(function(){var e,i=h(this),o=wpf.sanitizeHTML(i.find("input.label").val().trim()),t=i.find("input.value").val(),r=i.find("input.default").is(":checked"),i=i.data("key"),o=""!==o?o:wpforms_builder.choice_empty_label_tpl.replace("{number}",i);if(o+=c&&t?" - "+wpf.amountFormatCurrency(t):"",d?p.push({value:o,label:o}):(e=h(f.replace(/{label}/g,o)),n.append(e)),!0===r)switch(s){case"select":d?p[p.length-1].selected=!0:e.prop("selected","true");break;case"radio":case"checkbox":e.find("input").prop("checked","true")}}),d&&(o=n.prop("multiple")?"input.choices__input":".choices__inner .choices__placeholder",r=v.dropdownField.helpers.getInstance(n),a=h("#wpforms-field-option-"+e+"-dynamic_choices").val(),r.removeActiveItems(),r.setChoices(p,"value","label",!0),v.dropdownField.helpers.update(e,a),n.closest(".choices").find(o).toggleClass("wpforms-hidden",l))},fieldChoiceBulkAddToggle:function(e){var i=h(e),e=i.closest("label");if(i.hasClass("bulk-add-showing")){var o=e.next(".bulk-add-display");o.slideUp(400,function(){o.remove()}),i.find("span").text(wpforms_builder.bulk_add_show)}else{var t,r='<div class="bulk-add-display unfoldable-cont">';for(t in r+='<p class="heading wpforms-clear">'+wpforms_builder.bulk_add_heading+' <a href="#" class="toggle-bulk-add-presets">'+wpforms_builder.bulk_add_presets_show+"</a></p>",r+="<ul>",wpforms_preset_choices)r+='<li><a href="#" data-preset="'+t+'" class="bulk-add-preset-insert">'+wpforms_preset_choices[t].name+"</a></li>";r+="</ul>",r+='<textarea placeholder="'+wpforms_builder.bulk_add_placeholder+'"></textarea>',r+='<button class="bulk-add-insert wpforms-btn wpforms-btn-sm wpforms-btn-blue">'+wpforms_builder.bulk_add_button+"</button>",e.after(r+="</div>"),e.next(".bulk-add-display").slideDown(400,function(){h(this).find("textarea").focus()}),i.find("span").text(wpforms_builder.bulk_add_hide)}i.toggleClass("bulk-add-showing")},fieldChoiceBulkAddInsert:function(e){var i,o,t,r=h(e),s=r.closest(".wpforms-field-option-row"),n=s.find("textarea"),a=s.find(".choices-list"),l=a.find("li:first-of-type").clone().wrap("<div>").parent(),d=s.data("field-id"),e=a.data("field-type"),f=Number(a.attr("data-next-id")),p=n.val().split("\n"),c="";for(o in r.prop("disabled",!0).html(r.html()+" "+g.spinner),l.find("input.value,input.label").attr("value",""),i=l.html(),p)p.hasOwnProperty(o)&&(t=wpf.sanitizeHTML(p[o]).trim().replace(/"/g,"&quot;"),c+=i.replace(/\[choices\]\[(\d+)\]/g,"[choices]["+f+"]").replace(/data-key="(\d+)"/g,'data-key="'+f+'"').replace(/value="" class="label"/g,'value="'+t+'" class="label"').replace(/class="label" type="text" value=""/g,'class="label" type="text" value="'+t+'"'),f++);a.attr("data-next-id",f).append(c),v.fieldChoiceUpdate(e,d),b.trigger("wpformsFieldChoiceAdd"),v.fieldChoiceBulkAddToggle(s.find(".toggle-bulk-add-display"))},fieldTabToggle:function(e){var i;h(".wpforms-tab a").removeClass("active"),h(".wpforms-field, .wpforms-title-desc").removeClass("active"),"add-fields"===e?(h("#add-fields a").addClass("active"),h(".wpforms-field-options").hide(),h(".wpforms-add-fields").show()):(h("#field-options a").addClass("active"),"field-options"===e?((i=h(".wpforms-field").first()).addClass("active"),e=i.data("field-id")):h("#wpforms-field-"+e).addClass("active"),h(".wpforms-field-option").hide(),h("#wpforms-field-option-"+e).show(),h(".wpforms-add-fields").hide(),h(".wpforms-field-options").show())},fieldPagebreakAdd:function(e,i,o){"pagebreak"===o&&(g.pagebreakTop?g.pagebreakBottom||(g.pagebreakBottom=!0,v.fieldAdd("pagebreak",{position:"bottom",scroll:!1,defaults:{position:"bottom"}}).done(function(e){g.pagebreakBottom=e.data.field.id;var i=h("#wpforms-field-"+e.data.field.id);h("#wpforms-field-option-"+e.data.field.id).find(".wpforms-field-option-group").addClass("wpforms-pagebreak-bottom"),i.addClass("wpforms-field-stick wpforms-pagebreak-bottom")})):(g.pagebreakTop=!0,v.fieldAdd("pagebreak",{position:"top",scroll:!1,defaults:{position:"top",nav_align:"left"}}).done(function(e){g.pagebreakTop=e.data.field.id;var i=h("#wpforms-field-"+e.data.field.id);h("#wpforms-field-option-"+e.data.field.id).find(".wpforms-field-option-group").addClass("wpforms-pagebreak-top"),i.addClass("wpforms-field-stick wpforms-pagebreak-top")})))},fieldPagebreakDelete:function(e,i,o){var t,r,s;"pagebreak"===o&&(h("#wpforms-panel-fields .wpforms-field-pagebreak").not(".wpforms-pagebreak-top, .wpforms-pagebreak-bottom").length||(r=(t=(s=h("#wpforms-panel-fields .wpforms-preview-wrap")).find(".wpforms-pagebreak-top")).data("field-id"),s=(o=s.find(".wpforms-pagebreak-bottom")).data("field-id"),t.remove(),h("#wpforms-field-option-"+r).remove(),g.pagebreakTop=!1,o.remove(),h("#wpforms-field-option-"+s).remove(),g.pagebreakBottom=!1))},fieldPageBreakInitDisplayPrevious:function(e){var i=e.data("field-id"),o=h("#wpforms-field-option-row-"+i+"-prev_toggle"),t=h("#wpforms-field-option-row-"+i+"-prev"),i=e.find(".wpforms-pagebreak-prev");0<e.prevAll(".wpforms-field-pagebreak.wpforms-pagebreak-normal").length?(o.removeClass("hidden"),t.removeClass("hidden"),o.find("input").is(":checked")&&i.removeClass("wpforms-hidden").text(t.find("input").val())):(o.addClass("hidden"),t.addClass("hidden"),i.addClass("wpforms-hidden"))},fieldDynamicChoiceToggle:function(e){var i=h(e),o=i.parent(),t=i.val(),r=o.data("field-id"),s=h("#wpforms-field-option-"+r).find(".wpforms-field-option-hidden-type").val(),n=h("#wpforms-field-"+r),a=h("#wpforms-field-option-row-"+r+"-choices"),e=h("#wpforms-field-option-"+r+"-choices_images");if(v.fieldDynamicChoiceToggleImageChoices(),b.trigger("wpformsFieldDynamicChoiceToggle"),wpf.fieldOptionLoading(o),h("#wpforms-field-option-row-"+r+"-dynamic_post_type").remove(),h("#wpforms-field-option-row-"+r+"-dynamic_taxonomy").remove(),""===t){if(e.removeClass("wpforms-hidden"),a.find(".toggle-bulk-add-display").removeClass("wpforms-hidden"),h("#wpforms-field-"+r).find(".wpforms-alert").remove(),-1<["checkbox","radio","payment-multiple","payment-checkbox"].indexOf(s))return v.fieldChoiceUpdate(s,r),a.find("ul").removeClass("wpforms-hidden"),a.find(".wpforms-alert").addClass("wpforms-hidden"),void wpf.fieldOptionLoading(o,!0);var l,d=[],f=n.find(".primary-input");if(h("#wpforms-field-option-row-"+r+"-choices li").each(function(){var e=h(this);d.push({label:wpf.sanitizeHTML(e.find(".label").val()),selected:e.find(".default").is(":checked")})}),n.hasClass("wpforms-field-select")){var i=v.dropdownField.helpers.isModernSelect(f),p="";if(f.find("option").not(".placeholder").remove(),i&&d.length)v.dropdownField.helpers.update(r,!1);else for(l in d)p="<option",p+=d[l].selected?" selected>":">",p+=d[l].label+"</option>",f.append(p)}else for(l in s="radio",n.hasClass("wpforms-field-checkbox")&&(s="checkbox"),f.empty(),d)p='<li><input type="'+s+'" disabled',p+=d[l].selected?" selected>":">",p+=d[l].label+"</li>",f.append(p);a.find("ul").removeClass("wpforms-hidden"),a.find(".wpforms-alert").addClass("wpforms-hidden"),wpf.fieldOptionLoading(o,!0)}else{e.addClass("wpforms-hidden"),a.find(".toggle-bulk-add-display").addClass("wpforms-hidden");a={type:t,field_id:r,action:"wpforms_builder_dynamic_choices",nonce:wpforms_builder.nonce};h.post(wpforms_builder.ajax_url,a,function(e){e.success?o.after(e.data.markup):console.log(e),wpf.fieldOptionLoading(o,!0),wpf.initTooltips(),h("#wpforms-field-option-"+r+"-dynamic_"+t).find("option:first").prop("selected",!0),h("#wpforms-field-option-"+r+"-dynamic_"+t).trigger("change")}).fail(function(e,i,o){console.log(e.responseText)})}},fieldDynamicChoiceSource:function(e){var i=h(e),o=i.parent(),t=i.val(),r=o.data("field-id"),e=h("#wpforms-builder-form").data("id"),s=h("#wpforms-field-option-row-"+r+"-choices"),n=h("#wpforms-field-"+r),i=h("#wpforms-field-option-"+r+"-dynamic_choices option:selected").val(),a=20;wpf.fieldOptionLoading(o);e={type:i,source:t,field_id:r,form_id:e,action:"wpforms_builder_dynamic_source",nonce:wpforms_builder.nonce};h.post(wpforms_builder.ajax_url,e,function(e){return e.success?(s.find(".dynamic-name").text(e.data.source_name),s.find(".dynamic-type").text(e.data.type_name),s.find("ul").addClass("wpforms-hidden"),s.find(".wpforms-alert").removeClass("wpforms-hidden"),v.fieldDynamicChoiceSourceItems(n,e.data.items),n.hasClass("wpforms-field-select")&&(a=200),Number(e.data.total)>a&&(i=(i=(i=(i=(i=wpforms_builder.dynamic_choice_limit).replace("{source}",e.data.source_name)).replace("{type}",e.data.type_name)).replace("{limit}",a)).replace("{total}",e.data.total),h.alert({title:wpforms_builder.heads_up,content:i,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})),v.firstNChoicesAlert(r,e.data.total)):console.log(e),void wpf.fieldOptionLoading(o,!0);var i}).fail(function(e,i,o){console.log(e.responseText)})},fieldDynamicChoiceSourceItems:function(e,i){var o=e.find(".primary-input"),t=0;if(e.hasClass("wpforms-field-select"))v.dropdownField.helpers.isModernSelect(o)?v.fieldDynamicChoiceSourceForModernSelect(o,i):v.fieldDynamicChoiceSourceForClassicSelect(o,i);else{var r="radio";for(t in e.hasClass("wpforms-field-checkbox")&&(r="checkbox"),o.empty(),i)o.append('<li><input type="'+r+'" disabled> '+wpf.sanitizeHTML(i[t])+"</li>")}},fieldDynamicChoiceSourceForModernSelect:function(e,i){var o=v.dropdownField.helpers.getInstance(e),t=e.closest(".wpforms-field").data().fieldId;o.destroy(),v.dropdownField.helpers.updatePlaceholderChoice(o,t),v.fieldDynamicChoiceSourceForClassicSelect(e,i),v.dropdownField.events.choicesInit(e)},fieldDynamicChoiceSourceForClassicSelect:function(e,i){var o=0,t=i.length;for(e.find("option").not(".placeholder").remove();o<t;o++){var r=wpf.sanitizeHTML(i[o]);e.append('<option value="'+r+'">'+r+"</option>")}},fieldDynamicChoiceToggleImageChoices:function(){h("#wpforms-builder .wpforms-field-options .wpforms-field-option").each(function(e,i){var o=h(i),t=o.find(".wpforms-field-option-row-dynamic_choices select").val(),i=void 0!==t&&""!==t,t=o.find(".wpforms-field-option-row-choices_images input").is(":checked");o.find(".wpforms-field-option-row-choices_images").toggleClass("wpforms-hidden",i),t&&!i||o.find(".wpforms-field-option-row-choices_images_style").addClass("wpforms-hidden")})},firstNChoicesAlert:function(e,i){var o=wp.template("wpforms-choices-limit-message"),t={total:i},e=h("#wpforms-field-"+e);e.hasClass("wpforms-field-select")||(e.find(".wpforms-alert-dynamic").remove(),20<i&&e.find(".primary-input").after(o(t)))},fieldLayoutSelectorToggle:function(e){var i=h(e),e=i.closest("label"),o={"layout-1":[{class:"one-half",data:"wpforms-one-half wpforms-first"},{class:"one-half",data:"wpforms-one-half"}],"layout-2":[{class:"one-third",data:"wpforms-one-third wpforms-first"},{class:"one-third",data:"wpforms-one-third"},{class:"one-third",data:"wpforms-one-third"}],"layout-3":[{class:"one-fourth",data:"wpforms-one-fourth wpforms-first"},{class:"one-fourth",data:"wpforms-one-fourth"},{class:"one-fourth",data:"wpforms-one-fourth"},{class:"one-fourth",data:"wpforms-one-fourth"}],"layout-4":[{class:"one-third",data:"wpforms-one-third wpforms-first"},{class:"two-third",data:"wpforms-two-thirds"}],"layout-5":[{class:"two-third",data:"wpforms-two-thirds wpforms-first"},{class:"one-third",data:"wpforms-one-third"}],"layout-6":[{class:"one-fourth",data:"wpforms-one-fourth wpforms-first"},{class:"one-fourth",data:"wpforms-one-fourth"},{class:"two-fourth",data:"wpforms-two-fourths"}],"layout-7":[{class:"two-fourth",data:"wpforms-two-fourths wpforms-first"},{class:"one-fourth",data:"wpforms-one-fourth"},{class:"one-fourth",data:"wpforms-one-fourth"}],"layout-8":[{class:"one-fourth",data:"wpforms-one-fourth wpforms-first"},{class:"two-fourth",data:"wpforms-two-fourths"},{class:"one-fourth",data:"wpforms-one-fourth"}]};if(i.hasClass("layout-selector-showing")){var t=e.next(".layout-selector-display");t.slideUp(400,function(){t.remove()}),i.find("span").text(wpforms_builder.layout_selector_show)}else{var r,s='<div class="layout-selector-display unfoldable-cont">';for(r in s+='<p class="heading">'+wpforms_builder.layout_selector_layout+"</p>",s+='<div class="layouts">',o){var n,a=o[r];for(n in s+='<div class="layout-selector-display-layout">',a)s+='<span class="'+a[n].class+'" data-classes="'+a[n].data+'"></span>';s+="</div>"}e.after(s+="</div></div>"),e.next(".layout-selector-display").slideDown(),i.find("span").text(wpforms_builder.layout_selector_hide)}i.toggleClass("layout-selector-showing")},fieldLayoutSelectorLayout:function(e){e=h(e);e.closest("label");e.parent().find(".layout-selector-display-layout").not(e).remove(),e.parent().find(".heading").text(wpforms_builder.layout_selector_column),e.toggleClass("layout-selector-display-layout layout-selector-display-columns")},fieldLayoutSelectorInsert:function(e){var i=h(e),o=i.closest(".layout-selector-display"),t=o.parent(),e=t.find("label"),t=t.find("input[type=text]"),i=i.data("classes");t.val()&&(i=" "+i),t.insertAtCaret(i),o.slideUp(400,function(){o.remove()}),e.find(".toggle-layout-selector-display").removeClass("layout-selector-showing"),e.find(".toggle-layout-selector-display span").text(wpforms_builder.layout_selector_show)},bindUIActionsSettings:function(){b.on("click","#wpforms-panel-fields .wpforms-title-desc, #wpforms-panel-fields .wpforms-field-submit-button, .wpforms-center-form-name",function(e){e.preventDefault(),v.panelSwitch("settings"),(h(this).hasClass("wpforms-center-form-name")||h(this).hasClass("wpforms-title-desc"))&&setTimeout(function(){h("#wpforms-panel-field-settings-form_title").focus()},300)}),b.on("click",".wpforms-field-pagebreak-last button",function(e){e.preventDefault(),v.panelSwitch("settings"),h("#wpforms-panel-field-settings-pagebreak_prev").focus()}),b.on("input","#wpforms-panel-field-settings-pagebreak_prev",function(){h(".wpforms-field-pagebreak-last button").text(h(this).val())}),b.on("input","#wpforms-panel-field-settings-form_title, #wpforms-setup-name",function(){var e=h.trim(h(this).val());h(".wpforms-preview .wpforms-form-name").text(e),h(".wpforms-center-form-name.wpforms-form-name").text(e),v.trimFormTitle()}),b.on("input","#wpforms-panel-field-settings-form_desc",function(){h(".wpforms-form-desc").text(h(this).val())}),b.on("input","#wpforms-panel-field-settings-submit_text",function(){h(".wpforms-field-submit input[type=submit]").val(h(this).val())}),b.on("change","#wpforms-panel-field-settings-recaptcha",function(){v.captchaToggle()}),b.on("change",".wpforms-panel-field-confirmations-type",function(){v.confirmationFieldsToggle(h(this))}),b.on("change",".wpforms-panel-field-confirmations-message_entry_preview",v.confirmationEntryPreviewToggle),b.on("change","#wpforms-panel-field-settings-notification_enable",function(){v.notificationToggle()}),b.on("click",".wpforms-builder-settings-block-add",function(e){e.preventDefault(),wpforms_builder.pro&&v.settingsBlockAdd(h(this))}),b.on("click",".wpforms-builder-settings-block-edit",function(e){e.preventDefault();e=h(this);e.parents(".wpforms-builder-settings-block-header").find(".wpforms-builder-settings-block-name").hasClass("editing")?v.settingsBlockNameEditingHide(e):v.settingsBlockNameEditingShow(e)}),b.on("blur",".wpforms-builder-settings-block-name-edit input",function(e){h(e.relatedTarget).hasClass("wpforms-builder-settings-block-edit")||v.settingsBlockNameEditingHide(h(this))}),b.on("keypress",".wpforms-builder-settings-block-name-edit input",function(e){13===e.keyCode&&(v.settingsBlockNameEditingHide(h(this)),e.preventDefault())}),b.on("click",".wpforms-builder-settings-block-clone",function(e){e.preventDefault(),v.settingsBlockPanelClone(h(this))}),b.on("click",".wpforms-builder-settings-block-toggle",function(e){e.preventDefault(),v.settingsBlockPanelToggle(h(this))}),b.on("click",".wpforms-builder-settings-block-delete",function(e){e.preventDefault(),v.settingsBlockDelete(h(this))})},captchaToggle:function(){var e=b.find(".wpforms-field-recaptcha"),i=h("#wpforms-panel-field-settings-recaptcha"),o=(o=i.data("provider"))||"recaptcha";e.length&&(i.is(":checked")?e.show().toggleClass("is-recaptcha","recaptcha"===o):e.hide())},confirmationsSetup:function(){h(".wpforms-panel-field-confirmations-type").each(function(){v.confirmationFieldsToggle(h(this))}),h(".wpforms-panel-field-confirmations-message").each(function(){"undefined"!=typeof tinymce&&void 0!==wp.editor&&wp.editor.initialize(h(this).attr("id"),g.tinymceDefaults)}),b.on("focusout",".wpforms-panel-field-confirmations-redirect",function(e){var i=h(this),o=i.val().trim();i.val(o),wpf.isURL(o)||""===o||h.confirm({title:wpforms_builder.heads_up,content:wpforms_builder.redirect_url_field_error,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){i.focus()}}}})})},confirmationFieldsToggle:function(e){var i,o;e.length&&(i=e.val(),(o=e.closest(".wpforms-builder-settings-block-content")).find(".wpforms-panel-field").not(e.parent()).not(".wpforms-conditionals-enable-toggle").hide(),o.find(".wpforms-panel-field-confirmations-"+i).closest(".wpforms-panel-field").show(),"message"===i&&(o.find(".wpforms-panel-field-confirmations-message_scroll").closest(".wpforms-panel-field").show(),o.find(".wpforms-panel-field-confirmations-message_entry_preview").trigger("change").closest(".wpforms-panel-field").show()))},confirmationEntryPreviewToggle:function(){var e=h(this),i=e.closest(".wpforms-builder-settings-block-content").find(".wpforms-panel-field-confirmations-message_entry_preview_style").parent();e.is(":checked")?i.show():i.hide()},notificationToggle:function(){var e=h("#wpforms-panel-field-settings-notification_enable"),i=e.closest(".wpforms-panel-content-section").find(".wpforms-builder-settings-block"),e=e.is(":checked");h(".wpforms-notifications-add").toggleClass("wpforms-hidden",!e),e?i.show():i.hide()},notificationsByStatusAlerts:function(){b.on("change",".wpforms-panel-content-section-notifications .wpforms-notification-by-status-alert",function(e){var i,o,t=h(this);t.prop("checked")&&(o="",o=0===(i=h(".wpforms-radio-group-"+t.attr("data-radio-group")+":checked:not(#"+t.attr("id")+")")).length?(o=wpforms_builder.notification_by_status_enable_alert).replace(/%s/g,t.data("provider-title")):(o=(o=wpforms_builder.notification_by_status_switch_alert).replace(/%2\$s/g,i.data("provider-title"))).replace(/%1\$s/g,t.data("provider-title")),h.confirm({title:wpforms_builder.heads_up,content:o,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm"}}}))})},settingsBlockAdd:function(a){var l=Number(a.attr("data-next-id")),d=a.closest(".wpforms-panel-content-section").data("panel"),f=a.data("block-type"),e=wpforms_builder[f+"_prompt"],i='<input autofocus="" type="text" id="settings-block-name" placeholder="'+wpforms_builder[f+"_ph"]+'">',o='<p class="error">'+wpforms_builder[f+"_error"]+"</p>",t=h.confirm({container:b,title:!1,content:e+i+o,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){var e=h.trim(this.$content.find("input#settings-block-name").val()),i=this.$content.find(".error");if(""===e)return i.show(),!1;var o=a.closest(".wpforms-panel-content-section").find(".wpforms-builder-settings-block").first();wpf.restoreTooltips(o);var t=o.clone(),i=o.data("block-id");t.attr("data-block-id",l),t.find(".wpforms-builder-settings-block-header span").text(e),t.find("input, textarea, select").not(".from-name input").not(".from-email input").each(function(e,i){var o=h(this);o.attr("name")&&(o.val("").attr("name",o.attr("name").replace(/\[(\d+)\]/,"["+l+"]")),o.is("select")?(o.find("option").prop("selected",!1).attr("selected",!1),o.find("option:first").prop("selected",!0).attr("selected","selected")):"checkbox"===o.attr("type")?o.prop("checked",!1).attr("checked",!1).val("1"):o.val("").attr("value",""))});var s="wpforms-panel-field-"+d+"-",n=s+i;t.find('[id^="'+n+'"], [for^="'+n+'"]').each(function(e,i){var o=h(this),t="LABEL"===o.prop("tagName")?"for":"id",r=o.attr(t).replace(new RegExp(n,"g"),s+l);o.attr(t,r)});var r=i+"-notification-by-status";t.find('[data-radio-group="'+r+'"]').each(function(e,i){h(this).removeClass("wpforms-radio-group-"+r).addClass("wpforms-radio-group-"+l+"-notification-by-status").attr("data-radio-group",l+"-notification-by-status")}),t.find(".wpforms-builder-settings-block-header input").val(e).attr("value",e),"notification"===f&&(t.find(".email-msg textarea").val("{all_fields}").attr("value","{all_fields}"),t.find(".email-recipient input").val("{admin_email}").attr("value","{admin_email}")),t.removeClass("wpforms-builder-settings-block-default"),"confirmation"===f&&(t.find(".wpforms-panel-field-tinymce").remove(),"undefined"!=typeof WPForms&&t.find(".wpforms-panel-field-confirmations-type-wrap").after(WPForms.Admin.Builder.Templates.get("wpforms-builder-confirmations-message-field")({id:l})));e=t.find(".wpforms-conditional-block");e.length&&"undefined"!=typeof WPForms&&e.html(WPForms.Admin.Builder.Templates.get("wpforms-builder-conditional-logic-toggle-field")({id:l,type:f,actions:JSON.stringify(t.find(".wpforms-panel-field-conditional_logic-checkbox").data("actions")),actionDesc:t.find(".wpforms-panel-field-conditional_logic-checkbox").data("action-desc")}));e=t.find(".wpforms-field-map-table");e.length&&e.each(function(e,i){var o=h(i);o.find("tr:not(:first-child)").remove();var t=o.find(".key input"),i=o.find(".field select"),o=i.data("name");t.attr("value",""),i.attr("name","").attr("data-name",o.replace(/\[(\d+)\]/,"["+l+"]"))}),t=(t=t.wrap("<div>").parent().html()).replace(/\[conditionals\]\[(\d+)\]\[(\d+)\]/g,"[conditionals][0][0]"),o.before(t);o=o.prev();"confirmation"===f&&v.confirmationFieldsToggle(h(".wpforms-panel-field-confirmations-type").first()),"undefined"!=typeof tinymce&&void 0!==wp.editor&&"confirmation"===f&&wp.editor.initialize("wpforms-panel-field-confirmations-message-"+l,g.tinymceDefaults),wpf.initTooltips(),b.trigger("wpformsSettingsBlockAdded",[o]),a.attr("data-next-id",l+1)}},cancel:{text:wpforms_builder.cancel}}});b.on("keypress","#settings-block-name",function(e){13===e.keyCode&&h(t.buttons.confirm.el).trigger("click")})},settingsBlockNameEditingShow:function(e){e=e.parents(".wpforms-builder-settings-block-header");e.find(".wpforms-builder-settings-block-name").addClass("editing").hide(),e.find(".wpforms-builder-settings-block-name-edit").addClass("active"),wpf.focusCaretToEnd(e.find("input"))},settingsBlockNameEditingHide:function(e){var i=e.parents(".wpforms-builder-settings-block-header"),o=i.find(".wpforms-builder-settings-block-name"),t=i.find(".wpforms-builder-settings-block-name-edit"),i=t.find("input").val().trim(),e=e.closest(".wpforms-builder-settings-block").data("block-type");i.length||(i=wpforms_builder[e+"_def_name"]),t.find("input").val(i),o.text(i),o.removeClass("editing").show(),t.removeClass("active")},settingsBlockPanelClone:function(e){var i=e.closest(".wpforms-panel-content-section").find(".wpforms-builder-settings-block-add"),o=e.closest(".wpforms-builder-settings-block"),t=o.find(".wpforms-builder-settings-block-content"),r=parseInt(i.attr("data-next-id"),10),s=o.data("block-type"),e=o.find(".wpforms-builder-settings-block-name").text().trim()+wpforms_builder[s+"_clone"],t=t.is(":hidden");wpf.restoreTooltips(o);var n=o.clone(!1,!0);v.settingsBlockUpdateState(t,r,s),n.data("block-id",r),n.find(".wpforms-builder-settings-block-header span").text(e),n.find(".wpforms-builder-settings-block-header input").val(e),n.removeClass("wpforms-builder-settings-block-default"),i.attr("data-next-id",r+1),n.find("input, textarea, select").each(function(){var e=h(this);e.attr("name")&&e.attr("name",e.attr("name").replace(/\[(\d+)\]/,"["+r+"]")),e.data("name")&&e.data("name",e.data("name").replace(/\[(\d+)\]/,"["+r+"]")),e.attr("class")&&e.attr("class",e.attr("class").replace(/-(\d+)/,"-"+r)),e.attr("data-radio-group")&&e.attr("data-radio-group",e.attr("data-radio-group").replace(/(\d+)-/,r+"-"))}),n.find("*").each(function(){var e=h(this);e.attr("id")&&e.attr("id",e.attr("id").replace(/-(\d+)/,"-"+r)),e.attr("for")&&e.attr("for",e.attr("for").replace(/-(\d+)-/,"-"+r+"-")),e.data("input-name")&&e.data("input-name",e.data("input-name").replace(/\[(\d+)\]/,"["+r+"]"))}),o.find("select").each(function(){var e=h(this).attr("name"),i=h(this).attr("name").replace(/\[(\d+)\]/,"["+r+"]");n.find('select[name="'+i+'"]').val(h(this).attr("name",e).val())}),n.css("display","none").insertBefore(o).show("fast",function(){wpf.initTooltips()})},settingsBlockPanelToggle:function(e){var i=e.closest(".wpforms-builder-settings-block"),o=i.data("block-id"),t=i.data("block-type"),r=i.find(".wpforms-builder-settings-block-content"),s=r.is(":visible");r.stop().slideToggle({duration:400,start:function(){v.settingsBlockUpdateState(s,o,t)},always:function(){r.is(":visible")?e.html('<i class="fa fa-chevron-circle-up"></i>'):e.html('<i class="fa fa-chevron-circle-down"></i>')}})},settingsBlockDelete:function(e){var i=e.closest(".wpforms-panel-content-section"),o=e.closest(".wpforms-builder-settings-block"),t=o.data("block-type");i.find(".wpforms-builder-settings-block").length<2||h.confirm({title:!1,content:wpforms_builder[t+"_delete"],icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){var e=o.data("block-id"),i=o.data("block-type");h.post(wpforms_builder.ajax_url,{action:"wpforms_builder_settings_block_state_remove",nonce:wpforms_builder.nonce,block_id:e,block_type:i,form_id:g.formID}),o.remove(),b.trigger("wpformsSettingsBlockDeleted",[t,e])}},cancel:{text:wpforms_builder.cancel}}})},settingsBlockUpdateState:function(e,i,o){h.post(wpforms_builder.ajax_url,{action:"wpforms_builder_settings_block_state_save",state:e?"closed":"opened",form_id:g.formID,block_id:i,block_type:o,nonce:wpforms_builder.nonce})},bindUIActionsRevisions:function(){b.on("wpformsPanelSwitched",function(e,i){"revisions"===i&&(v.updateRevisionsList(),v.updateRevisionPreview())}),b.on("wpformsSaved",function(e){"revisions"===wpf.getQueryString("view")&&v.updateRevisionsList()})},updateRevisionsList:function(){var t=h("#wpforms-panel-revisions .wpforms-revisions-content"),i=h(".wpforms-panel-revisions-button .badge-exclamation");i.length&&h.post(wpforms_builder.ajax_url,{action:"wpforms_mark_panel_viewed",form_id:g.formID,nonce:wpforms_builder.nonce}).done(function(e){e.success?i.remove():wpf.debug(e)}).fail(function(e,i,o){wpf.debug(e.responseText||i||"")}),b.hasClass("wpforms-revisions-enabled")&&t.fadeTo(250,.25,function(){h.post(wpforms_builder.ajax_url,{action:"wpforms_get_form_revisions",form_id:g.formID,revision_id:wpf.getQueryString("revision_id"),nonce:wpforms_builder.nonce}).done(function(e){e.success?t.replaceWith(e.data.html):wpf.debug(e)}).fail(function(e,i,o){wpf.debug(e.responseText||i||""),t.fadeTo(250,1)})})},updateRevisionPreview:function(){var e=p.$formPreview.clone();e.find(".wpforms-field-duplicate, .wpforms-field-delete, .wpforms-field-helper, .wpforms-debug").remove().end(),e.find(".wpforms-field-wrap").removeClass("ui-sortable").addClass("ui-sortable-disabled"),e.find(".wpforms-field").removeClass("ui-sortable-handle ui-draggable ui-draggable-handle active").removeAttr("id data-field-id data-field-type").removeData(),e.find(".wpforms-field-submit-button").prop("disabled",!0),p.$revisionPreview.hasClass("has-preview")?p.$revisionPreview.find(".wpforms-preview-wrap").replaceWith(e):p.$revisionPreview.append(e).addClass("has-preview")},confirmSaveRevision:function(){h.confirm({title:wpforms_builder.heads_up,content:wpforms_builder.revision_update_confirm,icon:"fa fa-exclamation-circle",type:"orange",closeIcon:!1,buttons:{confirm:{text:wpforms_builder.save,btnClass:"btn-confirm",keys:["enter"],action:function(){b.addClass("wpforms-revision-is-saving"),WPFormsBuilder.formSave(!1).done(v.revisionSavedReload)}},cancel:{text:wpforms_builder.cancel,action:function(){WPFormsBuilder.setCloseConfirmation(!0)}}}})},revisionSavedReload:function(){wpf.updateQueryString("view",wpf.getQueryString("view")),wpf.removeQueryParam("revision_id"),a.location.reload()},bindUIActionsSaveExit:function(){b.on("click","#wpforms-embed",function(e){e.preventDefault(),h(this).hasClass("wpforms-disabled")||WPFormsFormEmbedWizard.openPopup()}),b.on("click","#wpforms-save",function(e){e.preventDefault(),v.formSave(!1)}),b.on("click","#wpforms-exit",function(e){e.preventDefault(),v.formExit()}),b.on("wpformsSaved",function(e,i){wpf.removeQueryParam("newform")})},formSave:function(i){var e=p.$saveButton,o=e.find("i.fa-check"),t=e.find("i.wpforms-loading-spinner"),r=e.find("span"),s=r.text();if(!b.hasClass("wpforms-is-revision")||b.hasClass("wpforms-revision-is-saving")){"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave(),r.text(wpforms_builder.saving),e.prop("disabled",!0),o.addClass("wpforms-hidden"),t.removeClass("wpforms-hidden");var n={action:"wpforms_save_form",data:JSON.stringify(h("#wpforms-builder-form").serializeArray()),id:g.formID,nonce:wpforms_builder.nonce};return h.post(wpforms_builder.ajax_url,n,function(e){e.success?(wpf.savedState=wpf.getFormState("#wpforms-builder-form"),wpf.initialSave=!1,b.trigger("wpformsSaved",e.data),!0===i&&v.isBuilderInPopup()?v.builderInPopupClose("saved"):!0===i&&(a.location.href=wpforms_builder.exit_url)):(wpf.debug(e),v.formSaveError(e.data))}).fail(function(e,i,o){wpf.debug(e),v.formSaveError()}).always(function(){r.text(s),e.prop("disabled",!1),t.addClass("wpforms-hidden"),o.removeClass("wpforms-hidden")})}v.confirmSaveRevision()},formSaveError:function(e){wpf.empty(e)&&(e=wpforms_builder.error_save_form),h.confirm({title:wpforms_builder.heads_up,content:"<p>"+e+"</p><p>"+wpforms_builder.error_contact_support+"</p>",icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},formExit:function(){v.isBuilderInPopup()&&v.formIsSaved()?v.builderInPopupClose("saved"):v.formIsSaved()?a.location.href=wpforms_builder.exit_url:h.confirm({title:!1,content:wpforms_builder.exit_confirm,icon:"fa fa-exclamation-circle",type:"orange",closeIcon:!0,buttons:{confirm:{text:wpforms_builder.save_exit,btnClass:"btn-confirm",keys:["enter"],action:function(){v.formSave(!0)}},cancel:{text:wpforms_builder.exit,action:function(){i=!1,v.isBuilderInPopup()?v.builderInPopupClose("canceled"):a.location.href=wpforms_builder.exit_url}}}})},setCloseConfirmation:function(e){i=!!e},formIsSaved:function(){return wpf.savedState==wpf.getFormState("#wpforms-builder-form")},isBuilderInPopup:function(){return a.self!==a.parent&&"wpforms-builder-iframe"===a.self.frameElement.id},builderInPopupClose:function(e){var i=a.parent.jQuery("#wpforms-builder-elementor-popup");i.find("#wpforms-builder-iframe").attr("src","about:blank"),i.fadeOut(),i.trigger("wpformsBuilderInPopupClose",[e,g.formID])},bindUIActionsGeneral:function(){b.on("click",".toggle-smart-tag-display",v.smartTagToggle),b.on("click",".smart-tags-list-display a",v.smartTagInsert),b.on("click",".wpforms-panel-fields-group.unfoldable .wpforms-panel-fields-group-title",v.toggleUnfoldableGroup),b.on("click",".wpforms-field-helper-hide ",v.hideFieldHelper),b.on("input",".wpforms-field-map-table .key-source",function(){var e=h(this).val(),i=h(this).parent().parent().find(".key-destination"),o=i.data("name");e&&i.attr("name",o.replace("{source}",e.replace(/[^0-9a-zA-Z_-]/gi,"")))}),b.on("click",".wpforms-field-map-table .remove",function(e){e.preventDefault(),v.fieldMapTableDeleteRow(e,h(this))}),b.on("click",".wpforms-field-map-table .add",function(e){e.preventDefault(),v.fieldMapTableAddRow(e,h(this))}),h(r).on("wpformsFieldUpdate",v.fieldMapSelect),b.on("input",".wpforms-money-input",function(e){var i=h(this),o=i.val(),t=i[0].selectionStart,r=i[0].selectionEnd;i.val(o.replace(/[^0-9.,]/g,"")),i[0].setSelectionRange(t,r)}),b.on("focusout",".wpforms-money-input",function(e){var i=h(this),o=i.val();if(!o)return o;o=wpf.amountSanitize(o),o=wpf.amountFormat(o);i.val(o)}),b.on("change",".wpforms-panel-field-toggle",function(){var e=h(this);e.prop("disabled")||(e.prop("disabled",!0),v.toggleOptionsGroup(e))}),b.on("change","#wpforms-panel-field-stripe-enable, #wpforms-panel-field-paypal_standard-enable, #wpforms-panel-field-authorize_net-enable, #wpforms-panel-field-square-enable",function(e){var i=h(this),o=i.attr("id").replace("wpforms-panel-field-","").replace("-enable",""),t=h('.wpforms-panel-content-section-notifications [id*="-'+o+'-wrap"]');i.prop("checked")?h("#wpforms-panel-field-settings-disable_entries").prop("checked")?(h.confirm({title:wpforms_builder.heads_up,content:wpforms_builder.payments_entries_off,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}}),i.prop("checked",!1)):t.removeClass("wpforms-hidden"):(t.addClass("wpforms-hidden"),t.find('input[id*="-'+o+'"]').prop("checked",!1))}),b.on("change","#wpforms-panel-field-settings-disable_entries",function(e){var i=h(this);i.prop("checked")&&(h("#wpforms-panel-field-stripe-enable").prop("checked")||h("#wpforms-panel-field-paypal_standard-enable").prop("checked")||h("#wpforms-panel-field-authorize_net-enable").prop("checked")||h("#wpforms-panel-field-square-enable").prop("checked")?(h.confirm({title:wpforms_builder.heads_up,content:wpforms_builder.payments_on_entries_off,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}}),i.prop("checked",!1)):h.alert({title:wpforms_builder.heads_up,content:wpforms_builder.disable_entries,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}}))}),b.on("click",".wpforms-image-upload-add",function(e){e.preventDefault();var i=h(this),o=i.parent(),t=wp.media.frames.wpforms_media_frame=wp.media({className:"media-frame wpforms-media-frame",frame:"select",multiple:!1,title:wpforms_builder.upload_image_title,library:{type:"image"},button:{text:wpforms_builder.upload_image_button}});t.on("select",function(){var e=t.state().get("selection").first().toJSON();o.find(".source").val(e.url),o.find(".preview").empty(),o.find(".preview").prepend('<img src="'+e.url+'"><a href="#" title="'+wpforms_builder.upload_image_remove+'" class="wpforms-image-upload-remove"><i class="fa fa-trash-o"></i></a>'),"hide"===i.data("after-upload")&&i.hide(),b.trigger("wpformsImageUploadAdd",[i,o])}),t.open()}),b.on("click",".wpforms-image-upload-remove",function(e){e.preventDefault();e=h(this).parent().parent();e.find(".preview").empty(),e.find(".wpforms-image-upload-add").show(),e.find(".source").val(""),b.trigger("wpformsImageUploadRemove",[h(this),e])}),b.on("blur",".wpforms-notification .wpforms-panel-field-text input",function(){v.validateEmailSmartTags(h(this))}),b.on("blur",".wpforms-notification .wpforms-panel-field-textarea textarea",function(){v.validateEmailSmartTags(h(this))}),b.on("click",".wpforms-fullscreen-notice-go-back",v.exitBack),h("#wpforms-builder-license-alert .close").on("click",v.exitBack)},toggleOptionsGroup:function(e){function i(){e.prop("disabled",!1)}var o=e.attr("name"),t=e.attr("type"),r="",o=h('.wpforms-panel-field-toggle-body[data-toggle="'+o+'"]');0!==o.length?(r="checkbox"!==t&&"radio"!==t||e.prop("checked")?e.val():"0",o.each(function(){var e=h(this);e.attr("data-toggle-value").toString()===r.toString()?e.slideDown("",i):e.slideUp("",i)})):i()},toggleAllOptionGroups:function(e){(e=e||b||h("#wpforms-builder")||h("body"))&&e.find(".wpforms-panel-field-toggle").each(function(){var e=h(this);e.prop("disabled",!0),v.toggleOptionsGroup(e)})},toggleUnfoldableGroup:function(e){e.preventDefault();var i=h(e.target).closest(".wpforms-panel-fields-group"),o=i.find(".wpforms-panel-fields-group-inner"),e="wpforms_fields_group_"+i.data("group");i.hasClass("opened")?(wpCookies.remove(e),i.removeClass("opened"),o.stop().slideUp()):(wpCookies.set(e,"true",2592e3),i.addClass("opened"),o.stop().slideDown())},hideFieldHelper:function(e){e.preventDefault(),e.stopPropagation();e=h(".wpforms-field-helper");wpCookies.set("wpforms_field_helper_hide","true",2592e3),e.hide()},smartTagToggle:function(e){e.preventDefault();var i=h(this),e=i.closest(".wpforms-panel-field,.wpforms-field-option-row");e.hasClass("smart-tags-toggling")||(e.addClass("smart-tags-toggling"),i.hasClass("smart-tag-showing")?v.removeSmartTagsList(i):v.insertSmartTagsList(i))},removeSmartTagsList:function(e){var i=e.closest(".wpforms-panel-field,.wpforms-field-option-row"),o=i.find(".smart-tags-list-display");e.find("span").text(wpforms_builder.smart_tags_show),o.slideUp("",function(){o.remove(),e.removeClass("smart-tag-showing"),i.removeClass("smart-tags-toggling")})},insertSmartTagsList:function(e){var i,o=e.closest(".wpforms-panel-field,.wpforms-field-option-row"),t=e.closest("label"),r=!0;t.length||(t=o.find("label"),r=!1),i=v.getSmartTagsList(e,-1!==t.attr("for").indexOf("wpforms-field-option-")),(r?t:e).after(i),e.find("span").text(wpforms_builder.smart_tags_hide),o.find(".smart-tags-list-display").slideDown("",function(){e.addClass("smart-tag-showing"),o.removeClass("smart-tags-toggling")})},getSmartTagsList:function(e,i){var o='<ul class="smart-tags-list-display unfoldable-cont">';return o+=v.getSmartTagsListFieldsElements(e),o+=v.getSmartTagsListOtherElements(e,i),o+="</ul>"},getSmartTagsListFieldsElements:function(e){var i,o=e.data("type"),t=v.getSmartTagsFields(e),r="";if(!["fields","all"].includes(o))return"";if(!t)return'<li class="heading">'+wpforms_builder.fields_unavailable+"</li>";for(i in r+='<li class="heading">'+wpforms_builder.fields_available+"</li>",wpf.orders.fields){var s=wpf.orders.fields[i];t[s]&&(r+=v.getSmartTagsListFieldsElement(t[s]))}return r},getSmartTagsFields:function(e){e=e.data("fields");return e&&e.length?wpf.getFields(e.split(","),!0):wpf.getFields(!1,!0)},getSmartTagsListFieldsElement:function(e){var i=e.label?wpf.encodeHTMLEntities(wpf.sanitizeHTML(e.label)):wpforms_builder.field+" #"+e.id;return'<li><a href="#" data-type="field" data-meta=\''+e.id+"'>"+i+"</a></li>"},getSmartTagsListOtherElements:function(e,i){var o,t,e=e.data("type");if("other"!==e&&"all"!==e)return"";for(t in o='<li class="heading">'+wpforms_builder.other+"</li>",wpforms_builder.smart_tags)i&&-1<wpforms_builder.smart_tags_disabled_for_fields.indexOf(t)||(o+='<li><a href="#" data-type="other" data-meta=\''+t+"'>"+wpforms_builder.smart_tags[t]+"</a></li>");return o},smartTagInsert:function(e){e.preventDefault();var i,o=h(this),t=o.closest(".smart-tags-list-display"),r=t.closest(".wpforms-panel-field,.wpforms-field-option-row"),s=r.find(".toggle-smart-tag-display"),n=r.find("input[type=text], textarea"),e=o.data("meta"),e="field"===o.data("type")?'{field_id="'+e+'"}':"{"+e+"}";"undefined"!=typeof tinyMCE&&(i=tinyMCE.get(n.prop("id")))&&!i.hasFocus()&&i.focus(!0),i&&!i.isHidden()?i.insertContent(e):(n.insertAtCaret(e=" "+e+" "),n.val(n.val().trim().replace("  "," ")),n.focus()),t.slideUp("",function(){t.remove()}),s.find("span").text(wpforms_builder.smart_tags_show),r.find(".toggle-smart-tag-display").removeClass("smart-tag-showing")},fieldMapTableDeleteRow:function(e,i){var o=h(i),t=o.closest("tr"),i=o.closest("table"),o=t.closest(".wpforms-builder-settings-block");"1"<i.find("tr").length&&(t.remove(),b.trigger("wpformsFieldMapTableDeletedRow",[o]))},fieldMapTableAddRow:function(e,i){var o=h(i).closest("tr"),i=o.closest(".wpforms-builder-settings-block"),o=o.clone().insertAfter(o);o.find("input").val(""),o.find("select :selected").prop("selected",!1),o.find(".key-destination").attr("name",""),b.trigger("wpformsFieldMapTableAddedRow",[i,o])},fieldMapSelect:function(e,l){h(".wpforms-field-map-select").each(function(e,i){var o,t=h(this),r=t.find("option:selected").val(),s=t.data("field-map-allowed"),n=t.data("field-map-placeholder");if(void 0!==n&&n||(n=wpforms_builder.select_field),t.empty().append(h("<option>",{value:"",text:n})),void 0!==s&&s){if(s=s.split(" "),l&&!h.isEmptyObject(l))for(var a in wpf.orders.fields)Object.prototype.hasOwnProperty.call(wpf.orders.fields,a)&&(o=wpf.orders.fields[a],a="",l[o]&&(a=void 0!==l[o].label&&""!==l[o].label.toString().trim()?wpf.sanitizeHTML(l[o].label.toString().trim()):wpforms_builder.field+" #"+o,(0<=h.inArray(l[o].type,s)||0<=h.inArray("all-fields",s))&&t.append(h("<option>",{value:l[o].id,text:a}))));r&&t.find('option[value="'+r+'"]').prop("selected",!0);r=t.data("custom-value-support");"boolean"==typeof r&&r&&t.append(h("<option>",{value:"custom_value",text:wpforms_builder.add_custom_value_label,class:"wpforms-field-map-option-custom-value"})),b.trigger("wpformsFieldSelectMapped",[t])}})},validateEmailSmartTags:function(e){var i=e.val();i&&(i=i.replace(/{(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))}/g,function(e){return e.slice(1,-1)}),e.val(i))},dismissNotice:function(){b.on("click",".wpforms-alert-dismissible .wpforms-dismiss-button",function(e){e.preventDefault();var e=h(this),i=e.closest(".wpforms-alert"),e=e.data("field-id");i.addClass("out"),setTimeout(function(){i.remove()},250),e&&h("#wpforms-field-option-"+e).remove()})},trimFormTitle:function(){var e,i=h(".wpforms-center-form-name");38<i.text().length&&(e=h.trim(i.text()).substring(0,38).split(" ").slice(0,-1).join(" ")+"...",i.text(e))},loadColorPickers:function(){h(".wpforms-color-picker").minicolors()},builderHotkeys:function(){h(r).keydown(function(e){if(e.ctrlKey){switch(e.keyCode){case 72:h(p.$helpButton,b).click();break;case 80:a.open(wpforms_builder.preview_url);break;case 66:h(p.$embedButton,b).click();break;case 69:a.open(wpforms_builder.entries_url);break;case 83:h(p.$saveButton,b).click();break;case 81:h(p.$exitButton,b).click();break;case 191:v.openKeyboardShortcutsModal();break;default:return}return!1}})},openKeyboardShortcutsModal:function(){h(".wpforms-builder-keyboard-shortcuts").length?jconfirm.instances[jconfirm.instances.length-1].close():h.alert({title:wpforms_builder.shortcuts_modal_title,content:wpforms_builder.shortcuts_modal_msg+wp.template("wpforms-builder-keyboard-shortcuts")(),icon:"fa fa-keyboard-o",type:"blue",boxWidth:"550px",smoothContent:!1,buttons:{confirm:{text:wpforms_builder.close,btnClass:"btn-confirm",keys:["enter"]}},onOpenBefore:function(){this.$body.addClass("wpforms-builder-keyboard-shortcuts")}})},registerTemplates:function(){"undefined"!=typeof WPForms&&WPForms.Admin.Builder.Templates.add(["wpforms-builder-confirmations-message-field","wpforms-builder-conditional-logic-toggle-field"])},exitBack:function(){1<a.history.length&&r.referrer?a.history.back():a.location.href=wpforms_builder.exit_url}};return v}(document,window,jQuery);WPFormsBuilder.init();